[2025-09-01 21:31:38,595] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', None)
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 100)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 5e-05)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-01 21:31:38,596] INFO: Running in classification mode
[2025-09-01 21:31:40,142] INFO: Using 2 files for training, range: (0, 1)
[2025-09-01 21:31:40,142] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-01 21:31:40,145] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:31:40,145] INFO: [0;37mselection: None[0m
[2025-09-01 21:31:40,145] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:31:40,145] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:31:40,145] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:31:40,145] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:31:40,145] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:31:40,145] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:31:40,145] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:31:40,145] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:31:40,145] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:31:40,148] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:31:40,148] INFO: [0;37mselection: None[0m
[2025-09-01 21:31:40,148] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:31:40,148] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:31:40,148] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:31:40,148] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:31:40,148] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:31:40,148] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:31:40,148] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:31:40,148] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:31:40,148] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:31:40,151] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:31:40,151] INFO: [0;37mselection: None[0m
[2025-09-01 21:31:40,151] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:31:40,151] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:31:40,151] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:31:40,151] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:31:40,151] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:31:40,151] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:31:40,152] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:31:40,152] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:31:40,152] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:31:40,154] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:31:40,154] INFO: [0;37mselection: None[0m
[2025-09-01 21:31:40,154] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:31:40,154] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:31:40,154] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:31:40,154] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:31:40,154] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:31:40,155] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:31:40,155] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:31:40,155] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:31:40,155] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:31:40,161] INFO: Network options: {}
[2025-09-01 21:31:40,726] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-01 21:31:40,727] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-01 21:31:40,727] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-01 21:31:40,727] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-01 21:33:10,939] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', None)
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-01 21:33:10,939] INFO: Running in classification mode
[2025-09-01 21:33:11,547] INFO: Using 2 files for training, range: (0, 1)
[2025-09-01 21:33:11,547] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-01 21:33:11,549] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:33:11,549] INFO: [0;37mselection: None[0m
[2025-09-01 21:33:11,550] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:33:11,550] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:33:11,550] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:33:11,550] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:33:11,550] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:33:11,550] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:33:11,550] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:33:11,550] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:33:11,550] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:33:11,552] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:33:11,552] INFO: [0;37mselection: None[0m
[2025-09-01 21:33:11,552] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:33:11,552] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:33:11,552] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:33:11,552] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:33:11,553] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:33:11,553] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:33:11,553] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:33:11,553] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:33:11,553] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:33:11,555] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:33:11,556] INFO: [0;37mselection: None[0m
[2025-09-01 21:33:11,556] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:33:11,556] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:33:11,556] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:33:11,556] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:33:11,556] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:33:11,556] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:33:11,556] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:33:11,556] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:33:11,556] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:33:11,558] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:33:11,559] INFO: [0;37mselection: None[0m
[2025-09-01 21:33:11,559] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:33:11,559] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:33:11,559] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:33:11,559] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:33:11,559] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:33:11,559] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:33:11,559] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:33:11,559] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:33:11,559] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:33:11,562] INFO: Network options: {}
[2025-09-01 21:33:11,821] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-01 21:33:11,821] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-01 21:33:11,821] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-01 21:33:11,821] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-01 21:34:12,437] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', None)
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-01 21:34:12,437] INFO: Running in classification mode
[2025-09-01 21:34:13,000] INFO: Using 2 files for training, range: (0, 1)
[2025-09-01 21:34:13,000] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-01 21:34:13,002] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:34:13,003] INFO: [0;37mselection: None[0m
[2025-09-01 21:34:13,003] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:34:13,003] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:34:13,003] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:34:13,003] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:34:13,003] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:34:13,003] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:34:13,003] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:34:13,003] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:34:13,003] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:34:13,005] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:34:13,005] INFO: [0;37mselection: None[0m
[2025-09-01 21:34:13,005] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:34:13,005] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:34:13,005] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:34:13,005] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:34:13,005] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:34:13,006] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:34:13,006] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:34:13,006] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:34:13,006] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:34:13,008] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:34:13,008] INFO: [0;37mselection: None[0m
[2025-09-01 21:34:13,008] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:34:13,008] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:34:13,008] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:34:13,008] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:34:13,008] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:34:13,008] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:34:13,008] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:34:13,008] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:34:13,008] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:34:13,010] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:34:13,010] INFO: [0;37mselection: None[0m
[2025-09-01 21:34:13,010] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:34:13,010] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:34:13,010] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:34:13,010] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:34:13,011] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:34:13,011] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:34:13,011] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:34:13,011] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:34:13,011] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:34:13,013] INFO: Network options: {}
[2025-09-01 21:34:13,234] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-01 21:34:13,234] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-01 21:34:13,235] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-01 21:34:13,235] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-01 21:34:13,624] INFO: [0;37mParticleNetWrapper(
  |0.134 M, 100.000% Params, 49.392 MMac, 100.000% MACs|
  (fc_out): Sequential(
    |0.025 M, 18.550% Params, 1.195 MMac, 2.420% MACs|
    (0): Linear(in_features=128, out_features=128, bias=True, |0.017 M, 12.302% Params, 786.56 KMac, 1.592% MACs|)
    (1): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 6.144 KMac, 0.012% MACs|)
    (2): Linear(in_features=128, out_features=64, bias=True, |0.008 M, 6.151% Params, 393.28 KMac, 0.796% MACs|)
    (3): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 3.072 KMac, 0.006% MACs|)
    (4): Linear(in_features=64, out_features=2, bias=True, |0.0 M, 0.097% Params, 6.146 KMac, 0.012% MACs|)
    (5): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 96.0 Mac, 0.000% MACs|)
  )
  (mod): ParticleNet(
    |0.109 M, 81.450% Params, 48.197 MMac, 97.580% MACs|
    (bn_fts): BatchNorm1d(4, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.006% Params, 384.0 Mac, 0.001% MACs|)
    (edge_convs): ModuleList(
      (0): EdgeConvBlock(
        |0.009 M, 7.057% Params, 7.149 MMac, 14.473% MACs|
        (convs): ModuleList(
          (0): Conv2d(8, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.001 M, 0.381% Params, 393.216 KMac, 0.796% MACs|)
          (1-2): 2 x Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 3.052% Params, 3.146 MMac, 6.369% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.095% Params, 98.304 KMac, 0.199% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 49.152 KMac, 0.100% MACs|)
        )
        (sc): Conv1d(4, 64, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.191% Params, 12.288 KMac, 0.025% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.095% Params, 6.144 KMac, 0.012% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.072 KMac, 0.006% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 43.487% Params, 39.045 MMac, 79.051% MACs|
        (convs): ModuleList(
          (0-2): 3 x Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 12.207% Params, 12.583 MMac, 25.475% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.191% Params, 196.608 KMac, 0.398% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 98.304 KMac, 0.199% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 6.104% Params, 393.216 KMac, 0.796% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.191% Params, 12.288 KMac, 0.025% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 6.144 KMac, 0.012% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.025 M, 18.501% Params, 1.198 MMac, 2.426% MACs|
      (0): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False, |0.025 M, 18.311% Params, 1.18 MMac, 2.388% MACs|)
      (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.191% Params, 12.288 KMac, 0.025% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 6.144 KMac, 0.012% MACs|)
    )
    (fc): Sequential(
      |0.017 M, 12.398% Params, 804.864 KMac, 1.630% MACs|
      (0): Sequential(
        |0.017 M, 12.398% Params, 804.864 KMac, 1.630% MACs|
        (0): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False, |0.016 M, 12.207% Params, 786.432 KMac, 1.592% MACs|)
        (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.191% Params, 12.288 KMac, 0.025% MACs|)
        (2): ReLU(|0.0 M, 0.000% Params, 6.144 KMac, 0.012% MACs|)
        (3): Dropout(p=0.2, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
    )
  )
)[0m
[2025-09-01 21:34:13,625] INFO: Computational complexity:       49.39 MMac
[2025-09-01 21:34:13,625] INFO: Number of parameters:           134.22 k
[2025-09-01 21:34:13,625] INFO: Using loss function CrossEntropyLoss() with options {}
[2025-09-01 21:34:13,737] INFO: Create Tensorboard summary writer with comment particlemask
[2025-09-01 21:34:13,742] INFO: Optimizer options: {}
[2025-09-01 21:34:15,070] INFO: --------------------------------------------------
[2025-09-01 21:34:15,071] INFO: Epoch #0 training
[2025-09-01 21:34:15,111] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:34:15,111] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:35:06,546] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', None)
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-01 21:35:06,547] INFO: Running in classification mode
[2025-09-01 21:35:07,247] INFO: Using 2 files for training, range: (0, 1)
[2025-09-01 21:35:07,247] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-01 21:35:07,249] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:35:07,249] INFO: [0;37mselection: None[0m
[2025-09-01 21:35:07,249] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:35:07,249] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:35:07,249] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:35:07,249] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:35:07,249] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:35:07,250] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:35:07,250] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:35:07,250] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:35:07,250] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:35:07,252] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:35:07,252] INFO: [0;37mselection: None[0m
[2025-09-01 21:35:07,252] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:35:07,252] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:35:07,252] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:35:07,252] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:35:07,252] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:35:07,252] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:35:07,252] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:35:07,252] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:35:07,252] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:35:07,254] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:35:07,254] INFO: [0;37mselection: None[0m
[2025-09-01 21:35:07,254] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:35:07,254] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:35:07,254] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:35:07,254] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:35:07,254] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:35:07,254] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:35:07,254] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:35:07,254] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:35:07,254] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:35:07,256] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:35:07,256] INFO: [0;37mselection: None[0m
[2025-09-01 21:35:07,256] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:35:07,256] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:35:07,256] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:35:07,256] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:35:07,256] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 48))
 - ('pf_features', (-1, 4, 48))
 - ('pf_mask', (-1, 1, 48))[0m
[2025-09-01 21:35:07,257] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 48, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:35:07,257] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:35:07,257] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:35:07,257] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:35:07,260] INFO: Network options: {}
[2025-09-01 21:35:07,598] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-01 21:35:07,599] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-01 21:35:07,599] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-01 21:35:07,599] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-01 21:35:08,059] INFO: [0;37mParticleNetWrapper(
  |0.118 M, 100.000% Params, 48.6 MMac, 100.000% MACs|
  (fc_out): Sequential(
    |0.008 M, 7.125% Params, 402.594 KMac, 0.828% MACs|
    (0): Linear(in_features=128, out_features=64, bias=True, |0.008 M, 7.014% Params, 393.28 KMac, 0.809% MACs|)
    (1): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 3.072 KMac, 0.006% MACs|)
    (2): Linear(in_features=64, out_features=2, bias=True, |0.0 M, 0.110% Params, 6.146 KMac, 0.013% MACs|)
    (3): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 96.0 Mac, 0.000% MACs|)
  )
  (mod): ParticleNet(
    |0.109 M, 92.875% Params, 48.197 MMac, 99.172% MACs|
    (bn_fts): BatchNorm1d(4, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 384.0 Mac, 0.001% MACs|)
    (edge_convs): ModuleList(
      (0): EdgeConvBlock(
        |0.009 M, 8.047% Params, 7.149 MMac, 14.709% MACs|
        (convs): ModuleList(
          (0): Conv2d(8, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.001 M, 0.435% Params, 393.216 KMac, 0.809% MACs|)
          (1-2): 2 x Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 3.480% Params, 3.146 MMac, 6.473% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 98.304 KMac, 0.202% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 49.152 KMac, 0.101% MACs|)
        )
        (sc): Conv1d(4, 64, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.217% Params, 12.288 KMac, 0.025% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 6.144 KMac, 0.013% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.072 KMac, 0.006% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 49.588% Params, 39.045 MMac, 80.340% MACs|
        (convs): ModuleList(
          (0-2): 3 x Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 13.919% Params, 12.583 MMac, 25.891% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 196.608 KMac, 0.405% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 98.304 KMac, 0.202% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 6.960% Params, 393.216 KMac, 0.809% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 12.288 KMac, 0.025% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 6.144 KMac, 0.013% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.025 M, 21.097% Params, 1.198 MMac, 2.465% MACs|
      (0): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False, |0.025 M, 20.879% Params, 1.18 MMac, 2.427% MACs|)
      (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 12.288 KMac, 0.025% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 6.144 KMac, 0.013% MACs|)
    )
    (fc): Sequential(
      |0.017 M, 14.137% Params, 804.864 KMac, 1.656% MACs|
      (0): Sequential(
        |0.017 M, 14.137% Params, 804.864 KMac, 1.656% MACs|
        (0): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False, |0.016 M, 13.919% Params, 786.432 KMac, 1.618% MACs|)
        (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 12.288 KMac, 0.025% MACs|)
        (2): ReLU(|0.0 M, 0.000% Params, 6.144 KMac, 0.013% MACs|)
        (3): Dropout(p=0.2, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
    )
  )
)[0m
[2025-09-01 21:35:08,060] INFO: Computational complexity:       48.6 MMac
[2025-09-01 21:35:08,060] INFO: Number of parameters:           117.71 k
[2025-09-01 21:35:08,060] INFO: Using loss function CrossEntropyLoss() with options {}
[2025-09-01 21:35:08,100] INFO: Create Tensorboard summary writer with comment particlemask
[2025-09-01 21:35:08,106] INFO: Optimizer options: {}
[2025-09-01 21:35:08,845] INFO: --------------------------------------------------
[2025-09-01 21:35:08,845] INFO: Epoch #0 training
[2025-09-01 21:35:08,874] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:35:08,885] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:36:12,726] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', None)
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-01 21:36:12,726] INFO: Running in classification mode
[2025-09-01 21:36:13,269] INFO: Using 2 files for training, range: (0, 1)
[2025-09-01 21:36:13,269] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-01 21:36:13,272] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:36:13,272] INFO: [0;37mselection: None[0m
[2025-09-01 21:36:13,272] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:36:13,272] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:36:13,272] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:36:13,272] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:36:13,272] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 21:36:13,272] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:36:13,272] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:36:13,272] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:36:13,272] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:36:13,274] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:36:13,274] INFO: [0;37mselection: None[0m
[2025-09-01 21:36:13,274] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:36:13,274] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:36:13,275] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:36:13,275] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:36:13,275] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 21:36:13,275] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:36:13,275] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:36:13,275] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:36:13,275] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:36:13,277] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:36:13,277] INFO: [0;37mselection: None[0m
[2025-09-01 21:36:13,277] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:36:13,277] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:36:13,277] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:36:13,278] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:36:13,278] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 21:36:13,278] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:36:13,278] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:36:13,278] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 21:36:13,278] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:36:13,280] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 21:36:13,281] INFO: [0;37mselection: None[0m
[2025-09-01 21:36:13,281] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 21:36:13,281] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 21:36:13,281] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 21:36:13,281] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 21:36:13,281] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 21:36:13,281] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 21:36:13,281] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 21:36:13,281] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 21:36:13,281] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 21:36:13,284] INFO: Network options: {}
[2025-09-01 21:36:13,495] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-01 21:36:13,496] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-01 21:36:13,496] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-01 21:36:13,496] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-01 21:36:13,855] INFO: [0;37mParticleNetWrapper(
  |0.118 M, 100.000% Params, 52.65 MMac, 100.000% MACs|
  (fc_out): Sequential(
    |0.008 M, 7.125% Params, 436.138 KMac, 0.828% MACs|
    (0): Linear(in_features=128, out_features=64, bias=True, |0.008 M, 7.014% Params, 426.048 KMac, 0.809% MACs|)
    (1): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
    (2): Linear(in_features=64, out_features=2, bias=True, |0.0 M, 0.110% Params, 6.658 KMac, 0.013% MACs|)
    (3): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 104.0 Mac, 0.000% MACs|)
  )
  (mod): ParticleNet(
    |0.109 M, 92.875% Params, 52.213 MMac, 99.172% MACs|
    (bn_fts): BatchNorm1d(4, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 416.0 Mac, 0.001% MACs|)
    (edge_convs): ModuleList(
      (0): EdgeConvBlock(
        |0.009 M, 8.047% Params, 7.744 MMac, 14.709% MACs|
        (convs): ModuleList(
          (0): Conv2d(8, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.001 M, 0.435% Params, 425.984 KMac, 0.809% MACs|)
          (1-2): 2 x Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 3.480% Params, 3.408 MMac, 6.473% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 106.496 KMac, 0.202% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 53.248 KMac, 0.101% MACs|)
        )
        (sc): Conv1d(4, 64, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 6.656 KMac, 0.013% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 49.588% Params, 42.299 MMac, 80.340% MACs|
        (convs): ModuleList(
          (0-2): 3 x Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 13.919% Params, 13.631 MMac, 25.891% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 212.992 KMac, 0.405% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 106.496 KMac, 0.202% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 6.960% Params, 425.984 KMac, 0.809% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.025 M, 21.097% Params, 1.298 MMac, 2.465% MACs|
      (0): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False, |0.025 M, 20.879% Params, 1.278 MMac, 2.427% MACs|)
      (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
    )
    (fc): Sequential(
      |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
      (0): Sequential(
        |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
        (0): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False, |0.016 M, 13.919% Params, 851.968 KMac, 1.618% MACs|)
        (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
        (3): Dropout(p=0.2, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
    )
  )
)[0m
[2025-09-01 21:36:13,856] INFO: Computational complexity:       52.65 MMac
[2025-09-01 21:36:13,856] INFO: Number of parameters:           117.71 k
[2025-09-01 21:36:13,856] INFO: Using loss function CrossEntropyLoss() with options {}
[2025-09-01 21:36:13,893] INFO: Create Tensorboard summary writer with comment particlemask
[2025-09-01 21:36:13,899] INFO: Optimizer options: {}
[2025-09-01 21:36:14,511] INFO: --------------------------------------------------
[2025-09-01 21:36:14,511] INFO: Epoch #0 training
[2025-09-01 21:36:14,538] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:36:14,551] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:37:02,056] INFO: Processed 199680 entries in total (avg. speed 4199.9 entries/s)
[2025-09-01 21:37:02,057] INFO: Train AvgLoss: 0.11869, AvgAcc: 0.94925
[2025-09-01 21:37:02,057] INFO: Train class distribution: 
    [(0, 8349610), (1, 2033750)]
[2025-09-01 21:37:02,085] INFO: Epoch #0 validating
[2025-09-01 21:37:02,124] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:37:04,064] INFO: Processed 9984 entries in total (avg. speed 5046.0 entries/s)
[2025-09-01 21:37:04,064] INFO: Evaluation class distribution: 
    [(0, 417390), (1, 101778)]
[2025-09-01 21:37:04,135] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:37:04,910] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9976788]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.98653298 0.01346702]
 [0.05010906 0.94989094]]
[2025-09-01 21:37:04,914] INFO: [1mEpoch #0: Current validation metric: 0.97935 (best: 0.97935)[0m
[2025-09-01 21:37:04,914] INFO: --------------------------------------------------
[2025-09-01 21:37:04,914] INFO: Epoch #1 training
[2025-09-01 21:37:04,933] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:37:04,944] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:37:52,936] INFO: Processed 199680 entries in total (avg. speed 4158.1 entries/s)
[2025-09-01 21:37:52,937] INFO: Train AvgLoss: 0.05198, AvgAcc: 0.97806
[2025-09-01 21:37:52,937] INFO: Train class distribution: 
    [(0, 8349552), (1, 2033808)]
[2025-09-01 21:37:52,960] INFO: Epoch #1 validating
[2025-09-01 21:37:53,000] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:37:54,405] INFO: Processed 9984 entries in total (avg. speed 6910.4 entries/s)
[2025-09-01 21:37:54,406] INFO: Evaluation class distribution: 
    [(0, 417349), (1, 101819)]
[2025-09-01 21:37:54,474] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:37:55,250] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.998538]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.99133339 0.00866661]
 [0.0480264  0.9519736 ]]
[2025-09-01 21:37:55,254] INFO: [1mEpoch #1: Current validation metric: 0.98361 (best: 0.98361)[0m
[2025-09-01 21:37:55,254] INFO: --------------------------------------------------
[2025-09-01 21:37:55,254] INFO: Epoch #2 training
[2025-09-01 21:37:55,271] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:37:55,284] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:38:41,528] INFO: Processed 199680 entries in total (avg. speed 4315.2 entries/s)
[2025-09-01 21:38:41,528] INFO: Train AvgLoss: 0.04529, AvgAcc: 0.98067
[2025-09-01 21:38:41,528] INFO: Train class distribution: 
    [(0, 8349537), (1, 2033823)]
[2025-09-01 21:38:41,550] INFO: Epoch #2 validating
[2025-09-01 21:38:41,572] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:38:42,831] INFO: Processed 9984 entries in total (avg. speed 7797.8 entries/s)
[2025-09-01 21:38:42,831] INFO: Evaluation class distribution: 
    [(0, 417360), (1, 101808)]
[2025-09-01 21:38:42,911] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:38:43,760] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9988527]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99107485 0.00892515]
 [0.03767877 0.96232123]]
[2025-09-01 21:38:43,762] INFO: [1mEpoch #2: Current validation metric: 0.98544 (best: 0.98544)[0m
[2025-09-01 21:38:43,762] INFO: --------------------------------------------------
[2025-09-01 21:38:43,762] INFO: Epoch #3 training
[2025-09-01 21:38:43,778] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:38:43,789] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:39:29,630] INFO: Processed 199680 entries in total (avg. speed 4353.5 entries/s)
[2025-09-01 21:39:29,630] INFO: Train AvgLoss: 0.04145, AvgAcc: 0.98227
[2025-09-01 21:39:29,630] INFO: Train class distribution: 
    [(0, 8349579), (1, 2033781)]
[2025-09-01 21:39:29,649] INFO: Epoch #3 validating
[2025-09-01 21:39:29,673] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:39:30,928] INFO: Processed 9984 entries in total (avg. speed 7813.1 entries/s)
[2025-09-01 21:39:30,928] INFO: Evaluation class distribution: 
    [(0, 417354), (1, 101814)]
[2025-09-01 21:39:31,005] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:39:31,909] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9990731]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99137902 0.00862098]
 [0.03164594 0.96835406]]
[2025-09-01 21:39:31,912] INFO: [1mEpoch #3: Current validation metric: 0.98686 (best: 0.98686)[0m
[2025-09-01 21:39:31,912] INFO: --------------------------------------------------
[2025-09-01 21:39:31,913] INFO: Epoch #4 training
[2025-09-01 21:39:31,931] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:39:31,942] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:40:21,945] INFO: Processed 199680 entries in total (avg. speed 3991.1 entries/s)
[2025-09-01 21:40:21,945] INFO: Train AvgLoss: 0.03887, AvgAcc: 0.98350
[2025-09-01 21:40:21,945] INFO: Train class distribution: 
    [(0, 8349589), (1, 2033771)]
[2025-09-01 21:40:21,966] INFO: Epoch #4 validating
[2025-09-01 21:40:21,994] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:40:23,427] INFO: Processed 9984 entries in total (avg. speed 6836.9 entries/s)
[2025-09-01 21:40:23,428] INFO: Evaluation class distribution: 
    [(0, 417345), (1, 101823)]
[2025-09-01 21:40:23,508] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:40:24,431] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9992291]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99322144 0.00677856]
 [0.03277256 0.96722744]]
[2025-09-01 21:40:24,435] INFO: [1mEpoch #4: Current validation metric: 0.98812 (best: 0.98812)[0m
[2025-09-01 21:40:24,435] INFO: --------------------------------------------------
[2025-09-01 21:40:24,435] INFO: Epoch #5 training
[2025-09-01 21:40:24,454] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:40:24,466] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:41:14,560] INFO: Processed 199680 entries in total (avg. speed 3983.6 entries/s)
[2025-09-01 21:41:14,561] INFO: Train AvgLoss: 0.03686, AvgAcc: 0.98440
[2025-09-01 21:41:14,561] INFO: Train class distribution: 
    [(0, 8349621), (1, 2033739)]
[2025-09-01 21:41:14,586] INFO: Epoch #5 validating
[2025-09-01 21:41:14,610] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:41:16,033] INFO: Processed 9984 entries in total (avg. speed 6903.7 entries/s)
[2025-09-01 21:41:16,034] INFO: Evaluation class distribution: 
    [(0, 417361), (1, 101807)]
[2025-09-01 21:41:16,123] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:41:17,023] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9993001]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99297251 0.00702749]
 [0.0278861  0.9721139 ]]
[2025-09-01 21:41:17,026] INFO: [1mEpoch #5: Current validation metric: 0.98888 (best: 0.98888)[0m
[2025-09-01 21:41:17,026] INFO: --------------------------------------------------
[2025-09-01 21:41:17,026] INFO: Epoch #6 training
[2025-09-01 21:41:17,045] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:41:17,056] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:42:07,613] INFO: Processed 199680 entries in total (avg. speed 3947.3 entries/s)
[2025-09-01 21:42:07,614] INFO: Train AvgLoss: 0.03551, AvgAcc: 0.98505
[2025-09-01 21:42:07,614] INFO: Train class distribution: 
    [(0, 8349696), (1, 2033664)]
[2025-09-01 21:42:07,634] INFO: Epoch #6 validating
[2025-09-01 21:42:07,659] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:42:09,052] INFO: Processed 9984 entries in total (avg. speed 7047.4 entries/s)
[2025-09-01 21:42:09,052] INFO: Evaluation class distribution: 
    [(0, 417363), (1, 101805)]
[2025-09-01 21:42:09,139] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:42:10,054] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99934226]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.9925197  0.0074803 ]
 [0.02437994 0.97562006]]
[2025-09-01 21:42:10,057] INFO: [1mEpoch #6: Current validation metric: 0.98921 (best: 0.98921)[0m
[2025-09-01 21:42:10,057] INFO: --------------------------------------------------
[2025-09-01 21:42:10,057] INFO: Epoch #7 training
[2025-09-01 21:42:10,075] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:42:10,087] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:43:00,494] INFO: Processed 199680 entries in total (avg. speed 3959.0 entries/s)
[2025-09-01 21:43:00,494] INFO: Train AvgLoss: 0.03451, AvgAcc: 0.98549
[2025-09-01 21:43:00,494] INFO: Train class distribution: 
    [(0, 8349562), (1, 2033798)]
[2025-09-01 21:43:00,518] INFO: Epoch #7 validating
[2025-09-01 21:43:00,542] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:43:01,956] INFO: Processed 9984 entries in total (avg. speed 6944.9 entries/s)
[2025-09-01 21:43:01,957] INFO: Evaluation class distribution: 
    [(0, 417361), (1, 101807)]
[2025-09-01 21:43:02,039] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:43:02,971] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9994051]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99396685 0.00603315]
 [0.02719852 0.97280148]]
[2025-09-01 21:43:02,975] INFO: [1mEpoch #7: Current validation metric: 0.98982 (best: 0.98982)[0m
[2025-09-01 21:43:02,975] INFO: --------------------------------------------------
[2025-09-01 21:43:02,975] INFO: Epoch #8 training
[2025-09-01 21:43:02,995] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:43:03,006] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:43:53,962] INFO: Processed 199680 entries in total (avg. speed 3916.3 entries/s)
[2025-09-01 21:43:53,962] INFO: Train AvgLoss: 0.03378, AvgAcc: 0.98580
[2025-09-01 21:43:53,962] INFO: Train class distribution: 
    [(0, 8349536), (1, 2033824)]
[2025-09-01 21:43:53,984] INFO: Epoch #8 validating
[2025-09-01 21:43:54,008] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:43:55,454] INFO: Processed 9984 entries in total (avg. speed 6794.6 entries/s)
[2025-09-01 21:43:55,454] INFO: Evaluation class distribution: 
    [(0, 417370), (1, 101798)]
[2025-09-01 21:43:55,540] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:43:56,442] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9993868]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99337518 0.00662482]
 [0.02502014 0.97497986]]
[2025-09-01 21:43:56,443] INFO: [1mEpoch #8: Current validation metric: 0.98977 (best: 0.98982)[0m
[2025-09-01 21:43:56,443] INFO: --------------------------------------------------
[2025-09-01 21:43:56,443] INFO: Epoch #9 training
[2025-09-01 21:43:56,463] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:43:56,475] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:44:47,722] INFO: Processed 199680 entries in total (avg. speed 3894.0 entries/s)
[2025-09-01 21:44:47,722] INFO: Train AvgLoss: 0.03312, AvgAcc: 0.98614
[2025-09-01 21:44:47,722] INFO: Train class distribution: 
    [(0, 8349527), (1, 2033833)]
[2025-09-01 21:44:47,745] INFO: Epoch #9 validating
[2025-09-01 21:44:47,772] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:44:49,214] INFO: Processed 9984 entries in total (avg. speed 6800.4 entries/s)
[2025-09-01 21:44:49,214] INFO: Evaluation class distribution: 
    [(0, 417350), (1, 101818)]
[2025-09-01 21:44:49,301] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:44:50,319] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9994298]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99391638 0.00608362]
 [0.02592862 0.97407138]]
[2025-09-01 21:44:50,322] INFO: [1mEpoch #9: Current validation metric: 0.99002 (best: 0.99002)[0m
[2025-09-01 21:44:50,322] INFO: --------------------------------------------------
[2025-09-01 21:44:50,323] INFO: Epoch #10 training
[2025-09-01 21:44:50,347] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:44:50,359] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:45:41,614] INFO: Processed 199680 entries in total (avg. speed 3893.1 entries/s)
[2025-09-01 21:45:41,615] INFO: Train AvgLoss: 0.03250, AvgAcc: 0.98640
[2025-09-01 21:45:41,615] INFO: Train class distribution: 
    [(0, 8349547), (1, 2033813)]
[2025-09-01 21:45:41,639] INFO: Epoch #10 validating
[2025-09-01 21:45:41,663] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:45:43,123] INFO: Processed 9984 entries in total (avg. speed 6732.8 entries/s)
[2025-09-01 21:45:43,123] INFO: Evaluation class distribution: 
    [(0, 417379), (1, 101789)]
[2025-09-01 21:45:43,199] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:45:44,101] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9994439]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99344241 0.00655759]
 [0.02323434 0.97676566]]
[2025-09-01 21:45:44,103] INFO: [1mEpoch #10: Current validation metric: 0.99017 (best: 0.99017)[0m
[2025-09-01 21:45:44,104] INFO: --------------------------------------------------
[2025-09-01 21:45:44,104] INFO: Epoch #11 training
[2025-09-01 21:45:44,122] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:45:44,132] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:46:35,473] INFO: Processed 199680 entries in total (avg. speed 3887.2 entries/s)
[2025-09-01 21:46:35,473] INFO: Train AvgLoss: 0.03189, AvgAcc: 0.98667
[2025-09-01 21:46:35,473] INFO: Train class distribution: 
    [(0, 8349583), (1, 2033777)]
[2025-09-01 21:46:35,495] INFO: Epoch #11 validating
[2025-09-01 21:46:35,518] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:46:36,895] INFO: Processed 9984 entries in total (avg. speed 7134.2 entries/s)
[2025-09-01 21:46:36,895] INFO: Evaluation class distribution: 
    [(0, 417325), (1, 101843)]
[2025-09-01 21:46:36,979] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:46:37,910] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9994804]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99426107 0.00573893]
 [0.02413519 0.97586481]]
[2025-09-01 21:46:37,913] INFO: [1mEpoch #11: Current validation metric: 0.99065 (best: 0.99065)[0m
[2025-09-01 21:46:37,913] INFO: --------------------------------------------------
[2025-09-01 21:46:37,913] INFO: Epoch #12 training
[2025-09-01 21:46:37,931] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:46:37,942] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:47:29,279] INFO: Processed 199680 entries in total (avg. speed 3887.4 entries/s)
[2025-09-01 21:47:29,280] INFO: Train AvgLoss: 0.03114, AvgAcc: 0.98708
[2025-09-01 21:47:29,280] INFO: Train class distribution: 
    [(0, 8349741), (1, 2033619)]
[2025-09-01 21:47:29,303] INFO: Epoch #12 validating
[2025-09-01 21:47:29,325] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:47:30,780] INFO: Processed 9984 entries in total (avg. speed 6760.2 entries/s)
[2025-09-01 21:47:30,780] INFO: Evaluation class distribution: 
    [(0, 417379), (1, 101789)]
[2025-09-01 21:47:30,871] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:47:31,832] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99953055]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99388086 0.00611914]
 [0.02045408 0.97954592]]
[2025-09-01 21:47:31,835] INFO: [1mEpoch #12: Current validation metric: 0.99107 (best: 0.99107)[0m
[2025-09-01 21:47:31,835] INFO: --------------------------------------------------
[2025-09-01 21:47:31,835] INFO: Epoch #13 training
[2025-09-01 21:47:31,855] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:47:31,868] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:48:23,447] INFO: Processed 199680 entries in total (avg. speed 3869.0 entries/s)
[2025-09-01 21:48:23,447] INFO: Train AvgLoss: 0.03042, AvgAcc: 0.98740
[2025-09-01 21:48:23,447] INFO: Train class distribution: 
    [(0, 8349511), (1, 2033849)]
[2025-09-01 21:48:23,469] INFO: Epoch #13 validating
[2025-09-01 21:48:23,493] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:48:24,912] INFO: Processed 9984 entries in total (avg. speed 6924.2 entries/s)
[2025-09-01 21:48:24,912] INFO: Evaluation class distribution: 
    [(0, 417340), (1, 101828)]
[2025-09-01 21:48:24,993] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:48:25,920] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9995273]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99400249 0.00599751]
 [0.02073104 0.97926896]]
[2025-09-01 21:48:25,925] INFO: [1mEpoch #13: Current validation metric: 0.99111 (best: 0.99111)[0m
[2025-09-01 21:48:25,925] INFO: --------------------------------------------------
[2025-09-01 21:48:25,925] INFO: Epoch #14 training
[2025-09-01 21:48:25,946] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:48:25,956] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:49:17,600] INFO: Processed 199680 entries in total (avg. speed 3864.2 entries/s)
[2025-09-01 21:49:17,600] INFO: Train AvgLoss: 0.02839, AvgAcc: 0.98825
[2025-09-01 21:49:17,600] INFO: Train class distribution: 
    [(0, 8349558), (1, 2033802)]
[2025-09-01 21:49:17,624] INFO: Epoch #14 validating
[2025-09-01 21:49:17,647] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:49:19,040] INFO: Processed 9984 entries in total (avg. speed 7057.5 entries/s)
[2025-09-01 21:49:19,040] INFO: Evaluation class distribution: 
    [(0, 417360), (1, 101808)]
[2025-09-01 21:49:19,124] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:49:20,078] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9995917]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99449636 0.00550364]
 [0.01935015 0.98064985]]
[2025-09-01 21:49:20,081] INFO: [1mEpoch #14: Current validation metric: 0.99178 (best: 0.99178)[0m
[2025-09-01 21:49:20,081] INFO: --------------------------------------------------
[2025-09-01 21:49:20,081] INFO: Epoch #15 training
[2025-09-01 21:49:20,099] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:49:20,110] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:50:11,589] INFO: Processed 199680 entries in total (avg. speed 3876.7 entries/s)
[2025-09-01 21:50:11,589] INFO: Train AvgLoss: 0.02718, AvgAcc: 0.98878
[2025-09-01 21:50:11,589] INFO: Train class distribution: 
    [(0, 8349605), (1, 2033755)]
[2025-09-01 21:50:11,613] INFO: Epoch #15 validating
[2025-09-01 21:50:11,637] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:50:13,055] INFO: Processed 9984 entries in total (avg. speed 6926.9 entries/s)
[2025-09-01 21:50:13,056] INFO: Evaluation class distribution: 
    [(0, 417358), (1, 101810)]
[2025-09-01 21:50:13,147] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:50:14,055] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996132]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.9945778 0.0054222]
 [0.0187899 0.9812101]]
[2025-09-01 21:50:14,057] INFO: [1mEpoch #15: Current validation metric: 0.99196 (best: 0.99196)[0m
[2025-09-01 21:50:14,057] INFO: --------------------------------------------------
[2025-09-01 21:50:14,057] INFO: Epoch #16 training
[2025-09-01 21:50:14,076] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:50:14,089] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:51:05,366] INFO: Processed 199680 entries in total (avg. speed 3891.7 entries/s)
[2025-09-01 21:51:05,367] INFO: Train AvgLoss: 0.02630, AvgAcc: 0.98918
[2025-09-01 21:51:05,367] INFO: Train class distribution: 
    [(0, 8349557), (1, 2033803)]
[2025-09-01 21:51:05,390] INFO: Epoch #16 validating
[2025-09-01 21:51:05,411] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:51:06,850] INFO: Processed 9984 entries in total (avg. speed 6842.1 entries/s)
[2025-09-01 21:51:06,851] INFO: Evaluation class distribution: 
    [(0, 417343), (1, 101825)]
[2025-09-01 21:51:06,931] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:51:07,847] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996294]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99512152 0.00487848]
 [0.02005401 0.97994599]]
[2025-09-01 21:51:07,849] INFO: [1mEpoch #16: Current validation metric: 0.99215 (best: 0.99215)[0m
[2025-09-01 21:51:07,849] INFO: --------------------------------------------------
[2025-09-01 21:51:07,849] INFO: Epoch #17 training
[2025-09-01 21:51:07,867] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:51:07,881] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:51:59,284] INFO: Processed 199680 entries in total (avg. speed 3882.3 entries/s)
[2025-09-01 21:51:59,284] INFO: Train AvgLoss: 0.02596, AvgAcc: 0.98933
[2025-09-01 21:51:59,284] INFO: Train class distribution: 
    [(0, 8349621), (1, 2033739)]
[2025-09-01 21:51:59,308] INFO: Epoch #17 validating
[2025-09-01 21:51:59,331] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:52:00,736] INFO: Processed 9984 entries in total (avg. speed 6994.0 entries/s)
[2025-09-01 21:52:00,736] INFO: Evaluation class distribution: 
    [(0, 417356), (1, 101812)]
[2025-09-01 21:52:00,823] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:52:01,762] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996358]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99483894 0.00516106]
 [0.01886811 0.98113189]]
[2025-09-01 21:52:01,765] INFO: [1mEpoch #17: Current validation metric: 0.99215 (best: 0.99215)[0m
[2025-09-01 21:52:01,765] INFO: --------------------------------------------------
[2025-09-01 21:52:01,765] INFO: Epoch #18 training
[2025-09-01 21:52:01,785] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:52:01,797] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:52:53,253] INFO: Processed 199680 entries in total (avg. speed 3878.2 entries/s)
[2025-09-01 21:52:53,254] INFO: Train AvgLoss: 0.02578, AvgAcc: 0.98943
[2025-09-01 21:52:53,254] INFO: Train class distribution: 
    [(0, 8349678), (1, 2033682)]
[2025-09-01 21:52:53,276] INFO: Epoch #18 validating
[2025-09-01 21:52:53,299] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:52:54,735] INFO: Processed 9984 entries in total (avg. speed 6844.8 entries/s)
[2025-09-01 21:52:54,736] INFO: Evaluation class distribution: 
    [(0, 417350), (1, 101818)]
[2025-09-01 21:52:54,820] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:52:55,745] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996451]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99495867 0.00504133]
 [0.0186411  0.9813589 ]]
[2025-09-01 21:52:55,747] INFO: [1mEpoch #18: Current validation metric: 0.99229 (best: 0.99229)[0m
[2025-09-01 21:52:55,747] INFO: --------------------------------------------------
[2025-09-01 21:52:55,747] INFO: Epoch #19 training
[2025-09-01 21:52:55,767] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 21:52:55,779] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 21:53:47,363] INFO: Processed 199680 entries in total (avg. speed 3868.6 entries/s)
[2025-09-01 21:53:47,363] INFO: Train AvgLoss: 0.02568, AvgAcc: 0.98949
[2025-09-01 21:53:47,363] INFO: Train class distribution: 
    [(0, 8349735), (1, 2033625)]
[2025-09-01 21:53:47,390] INFO: Epoch #19 validating
[2025-09-01 21:53:47,414] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 21:53:48,835] INFO: Processed 9984 entries in total (avg. speed 6911.5 entries/s)
[2025-09-01 21:53:48,835] INFO: Evaluation class distribution: 
    [(0, 417349), (1, 101819)]
[2025-09-01 21:53:48,915] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 21:53:49,820] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964327]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99497303 0.00502697]
 [0.01874896 0.98125104]]
[2025-09-01 21:53:49,820] INFO: [1mEpoch #19: Current validation metric: 0.99228 (best: 0.99229)[0m
[2025-09-01 22:33:34,144] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask_2B_drop_0.1.pt')
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 5e-05)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-01 22:33:34,144] INFO: Running in classification mode
[2025-09-01 22:33:35,515] INFO: Using 2 files for training, range: (0, 1)
[2025-09-01 22:33:35,515] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-01 22:33:35,518] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 22:33:35,518] INFO: [0;37mselection: None[0m
[2025-09-01 22:33:35,518] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 22:33:35,518] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 22:33:35,518] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 22:33:35,518] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 22:33:35,518] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 22:33:35,518] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 22:33:35,518] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 22:33:35,519] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 22:33:35,519] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 22:33:35,521] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 22:33:35,521] INFO: [0;37mselection: None[0m
[2025-09-01 22:33:35,521] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 22:33:35,521] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 22:33:35,521] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 22:33:35,521] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 22:33:35,521] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 22:33:35,521] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 22:33:35,521] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 22:33:35,521] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 22:33:35,521] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 22:33:35,523] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 22:33:35,523] INFO: [0;37mselection: None[0m
[2025-09-01 22:33:35,523] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 22:33:35,523] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 22:33:35,523] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 22:33:35,523] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 22:33:35,523] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 22:33:35,523] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 22:33:35,523] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 22:33:35,523] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-01 22:33:35,523] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 22:33:35,525] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-01 22:33:35,526] INFO: [0;37mselection: None[0m
[2025-09-01 22:33:35,526] INFO: [0;37mtest_time_selection: None[0m
[2025-09-01 22:33:35,526] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-01 22:33:35,526] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-01 22:33:35,526] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_vx', 'Part_vy', 'Part_vz'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-01 22:33:35,526] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 3, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-01 22:33:35,526] INFO: [0;37mpreprocess_params:
 - ('Part_vx', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vy', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_vz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-01 22:33:35,526] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-01 22:33:35,526] INFO: [0;37mobserver_names: ()[0m
[2025-09-01 22:33:35,526] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-01 22:33:35,530] INFO: Network options: {}
[2025-09-01 22:33:35,569] INFO: Model initialized with weights from /home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask_2B_drop_0.1.pt
 ... Missing: []
 ... Unexpected: []
[2025-09-01 22:33:35,878] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-01 22:33:35,879] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-01 22:33:35,880] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-01 22:33:35,880] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-01 22:33:37,386] INFO: [0;37mParticleNetWrapper(
  |0.118 M, 100.000% Params, 52.65 MMac, 100.000% MACs|
  (fc_out): Sequential(
    |0.008 M, 7.125% Params, 436.138 KMac, 0.828% MACs|
    (0): Linear(in_features=128, out_features=64, bias=True, |0.008 M, 7.014% Params, 426.048 KMac, 0.809% MACs|)
    (1): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
    (2): Linear(in_features=64, out_features=2, bias=True, |0.0 M, 0.110% Params, 6.658 KMac, 0.013% MACs|)
    (3): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 104.0 Mac, 0.000% MACs|)
  )
  (mod): ParticleNet(
    |0.109 M, 92.875% Params, 52.213 MMac, 99.172% MACs|
    (bn_fts): BatchNorm1d(4, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 416.0 Mac, 0.001% MACs|)
    (edge_convs): ModuleList(
      (0): EdgeConvBlock(
        |0.009 M, 8.047% Params, 7.744 MMac, 14.709% MACs|
        (convs): ModuleList(
          (0): Conv2d(8, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.001 M, 0.435% Params, 425.984 KMac, 0.809% MACs|)
          (1-2): 2 x Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 3.480% Params, 3.408 MMac, 6.473% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 106.496 KMac, 0.202% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 53.248 KMac, 0.101% MACs|)
        )
        (sc): Conv1d(4, 64, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 6.656 KMac, 0.013% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 49.588% Params, 42.299 MMac, 80.340% MACs|
        (convs): ModuleList(
          (0-2): 3 x Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 13.919% Params, 13.631 MMac, 25.891% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 212.992 KMac, 0.405% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 106.496 KMac, 0.202% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 6.960% Params, 425.984 KMac, 0.809% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.025 M, 21.097% Params, 1.298 MMac, 2.465% MACs|
      (0): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False, |0.025 M, 20.879% Params, 1.278 MMac, 2.427% MACs|)
      (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
    )
    (fc): Sequential(
      |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
      (0): Sequential(
        |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
        (0): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False, |0.016 M, 13.919% Params, 851.968 KMac, 1.618% MACs|)
        (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
        (3): Dropout(p=0.2, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
    )
  )
)[0m
[2025-09-01 22:33:37,387] INFO: Computational complexity:       52.65 MMac
[2025-09-01 22:33:37,387] INFO: Number of parameters:           117.71 k
[2025-09-01 22:33:37,388] INFO: Using loss function CrossEntropyLoss() with options {}
[2025-09-01 22:33:37,491] INFO: Create Tensorboard summary writer with comment particlemask
[2025-09-01 22:33:37,498] INFO: Optimizer options: {}
[2025-09-01 22:33:38,917] INFO: --------------------------------------------------
[2025-09-01 22:33:38,918] INFO: Epoch #0 training
[2025-09-01 22:33:38,985] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:33:38,994] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:34:25,268] INFO: Processed 199680 entries in total (avg. speed 4308.1 entries/s)
[2025-09-01 22:34:25,269] INFO: Train AvgLoss: 0.02568, AvgAcc: 0.98943
[2025-09-01 22:34:25,269] INFO: Train class distribution: 
    [(0, 8349685), (1, 2033675)]
[2025-09-01 22:34:25,288] INFO: Epoch #0 validating
[2025-09-01 22:34:25,311] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:34:26,506] INFO: Processed 9984 entries in total (avg. speed 8199.2 entries/s)
[2025-09-01 22:34:26,507] INFO: Evaluation class distribution: 
    [(0, 417332), (1, 101836)]
[2025-09-01 22:34:26,592] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:34:27,400] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996435]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99488417 0.00511583]
 [0.01839232 0.98160768]]
[2025-09-01 22:34:27,402] INFO: [1mEpoch #0: Current validation metric: 0.99228 (best: 0.99228)[0m
[2025-09-01 22:34:27,402] INFO: --------------------------------------------------
[2025-09-01 22:34:27,402] INFO: Epoch #1 training
[2025-09-01 22:34:27,423] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:34:27,434] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:35:12,952] INFO: Processed 199680 entries in total (avg. speed 4383.8 entries/s)
[2025-09-01 22:35:12,952] INFO: Train AvgLoss: 0.02565, AvgAcc: 0.98951
[2025-09-01 22:35:12,953] INFO: Train class distribution: 
    [(0, 8349597), (1, 2033763)]
[2025-09-01 22:35:12,978] INFO: Epoch #1 validating
[2025-09-01 22:35:13,002] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:35:14,465] INFO: Processed 9984 entries in total (avg. speed 6718.7 entries/s)
[2025-09-01 22:35:14,465] INFO: Evaluation class distribution: 
    [(0, 417356), (1, 101812)]
[2025-09-01 22:35:14,553] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:35:15,459] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.999646]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.99494197 0.00505803]
 [0.01851452 0.98148548]]
[2025-09-01 22:35:15,465] INFO: [1mEpoch #1: Current validation metric: 0.99230 (best: 0.99230)[0m
[2025-09-01 22:35:15,466] INFO: --------------------------------------------------
[2025-09-01 22:35:15,466] INFO: Epoch #2 training
[2025-09-01 22:35:15,491] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:35:15,502] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:36:03,122] INFO: Processed 199680 entries in total (avg. speed 4190.1 entries/s)
[2025-09-01 22:36:03,123] INFO: Train AvgLoss: 0.02562, AvgAcc: 0.98949
[2025-09-01 22:36:03,123] INFO: Train class distribution: 
    [(0, 8349615), (1, 2033745)]
[2025-09-01 22:36:03,151] INFO: Epoch #2 validating
[2025-09-01 22:36:03,198] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:36:04,546] INFO: Processed 9984 entries in total (avg. speed 7166.5 entries/s)
[2025-09-01 22:36:04,546] INFO: Evaluation class distribution: 
    [(0, 417347), (1, 101821)]
[2025-09-01 22:36:04,625] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:36:05,425] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964654]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99492748 0.00507252]
 [0.01832628 0.98167372]]
[2025-09-01 22:36:05,440] INFO: [1mEpoch #2: Current validation metric: 0.99233 (best: 0.99233)[0m
[2025-09-01 22:36:05,440] INFO: --------------------------------------------------
[2025-09-01 22:36:05,440] INFO: Epoch #3 training
[2025-09-01 22:36:05,459] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:36:05,469] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:36:52,598] INFO: Processed 199680 entries in total (avg. speed 4234.3 entries/s)
[2025-09-01 22:36:52,598] INFO: Train AvgLoss: 0.02563, AvgAcc: 0.98947
[2025-09-01 22:36:52,599] INFO: Train class distribution: 
    [(0, 8349588), (1, 2033772)]
[2025-09-01 22:36:52,618] INFO: Epoch #3 validating
[2025-09-01 22:36:52,644] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:36:53,903] INFO: Processed 9984 entries in total (avg. speed 7771.2 entries/s)
[2025-09-01 22:36:53,904] INFO: Evaluation class distribution: 
    [(0, 417351), (1, 101817)]
[2025-09-01 22:36:53,977] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:36:54,782] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996448]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99507848 0.00492152]
 [0.0188279  0.9811721 ]]
[2025-09-01 22:36:54,783] INFO: [1mEpoch #3: Current validation metric: 0.99235 (best: 0.99235)[0m
[2025-09-01 22:36:54,783] INFO: --------------------------------------------------
[2025-09-01 22:36:54,783] INFO: Epoch #4 training
[2025-09-01 22:36:54,803] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:36:54,815] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:37:42,180] INFO: Processed 199680 entries in total (avg. speed 4213.0 entries/s)
[2025-09-01 22:37:42,180] INFO: Train AvgLoss: 0.02561, AvgAcc: 0.98949
[2025-09-01 22:37:42,180] INFO: Train class distribution: 
    [(0, 8349469), (1, 2033891)]
[2025-09-01 22:37:42,197] INFO: Epoch #4 validating
[2025-09-01 22:37:42,217] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:37:43,481] INFO: Processed 9984 entries in total (avg. speed 7781.2 entries/s)
[2025-09-01 22:37:43,481] INFO: Evaluation class distribution: 
    [(0, 417388), (1, 101780)]
[2025-09-01 22:37:43,570] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:37:44,397] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964535]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99506694 0.00493306]
 [0.01870702 0.98129298]]
[2025-09-01 22:37:44,400] INFO: [1mEpoch #4: Current validation metric: 0.99237 (best: 0.99237)[0m
[2025-09-01 22:37:44,400] INFO: --------------------------------------------------
[2025-09-01 22:37:44,400] INFO: Epoch #5 training
[2025-09-01 22:37:44,419] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:37:44,429] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:38:31,992] INFO: Processed 199680 entries in total (avg. speed 4195.7 entries/s)
[2025-09-01 22:38:31,992] INFO: Train AvgLoss: 0.02563, AvgAcc: 0.98948
[2025-09-01 22:38:31,992] INFO: Train class distribution: 
    [(0, 8349629), (1, 2033731)]
[2025-09-01 22:38:32,015] INFO: Epoch #5 validating
[2025-09-01 22:38:32,037] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:38:33,296] INFO: Processed 9984 entries in total (avg. speed 7799.2 entries/s)
[2025-09-01 22:38:33,296] INFO: Evaluation class distribution: 
    [(0, 417364), (1, 101804)]
[2025-09-01 22:38:33,367] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:38:34,163] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996466]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99491571 0.00508429]
 [0.01828022 0.98171978]]
[2025-09-01 22:38:34,163] INFO: [1mEpoch #5: Current validation metric: 0.99233 (best: 0.99237)[0m
[2025-09-01 22:38:34,163] INFO: --------------------------------------------------
[2025-09-01 22:38:34,163] INFO: Epoch #6 training
[2025-09-01 22:38:34,179] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:38:34,190] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:39:21,931] INFO: Processed 199680 entries in total (avg. speed 4180.3 entries/s)
[2025-09-01 22:39:21,931] INFO: Train AvgLoss: 0.02556, AvgAcc: 0.98949
[2025-09-01 22:39:21,932] INFO: Train class distribution: 
    [(0, 8349498), (1, 2033862)]
[2025-09-01 22:39:21,949] INFO: Epoch #6 validating
[2025-09-01 22:39:21,970] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:39:23,228] INFO: Processed 9984 entries in total (avg. speed 7812.3 entries/s)
[2025-09-01 22:39:23,228] INFO: Evaluation class distribution: 
    [(0, 417351), (1, 101817)]
[2025-09-01 22:39:23,299] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:39:24,122] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996461]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99505692 0.00494308]
 [0.01900468 0.98099532]]
[2025-09-01 22:39:24,122] INFO: [1mEpoch #6: Current validation metric: 0.99230 (best: 0.99237)[0m
[2025-09-01 22:39:24,123] INFO: --------------------------------------------------
[2025-09-01 22:39:24,123] INFO: Epoch #7 training
[2025-09-01 22:39:24,139] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:39:24,151] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:40:11,825] INFO: Processed 199680 entries in total (avg. speed 4186.0 entries/s)
[2025-09-01 22:40:11,825] INFO: Train AvgLoss: 0.02553, AvgAcc: 0.98954
[2025-09-01 22:40:11,825] INFO: Train class distribution: 
    [(0, 8349511), (1, 2033849)]
[2025-09-01 22:40:11,843] INFO: Epoch #7 validating
[2025-09-01 22:40:11,863] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:40:13,120] INFO: Processed 9984 entries in total (avg. speed 7824.1 entries/s)
[2025-09-01 22:40:13,120] INFO: Evaluation class distribution: 
    [(0, 417337), (1, 101831)]
[2025-09-01 22:40:13,198] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:40:14,042] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996478]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.9950304  0.0049696 ]
 [0.01868783 0.98131217]]
[2025-09-01 22:40:14,042] INFO: [1mEpoch #7: Current validation metric: 0.99234 (best: 0.99237)[0m
[2025-09-01 22:40:14,042] INFO: --------------------------------------------------
[2025-09-01 22:40:14,042] INFO: Epoch #8 training
[2025-09-01 22:40:14,061] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:40:14,073] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:41:01,882] INFO: Processed 199680 entries in total (avg. speed 4174.0 entries/s)
[2025-09-01 22:41:01,882] INFO: Train AvgLoss: 0.02547, AvgAcc: 0.98954
[2025-09-01 22:41:01,882] INFO: Train class distribution: 
    [(0, 8349795), (1, 2033565)]
[2025-09-01 22:41:01,900] INFO: Epoch #8 validating
[2025-09-01 22:41:01,920] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:41:03,219] INFO: Processed 9984 entries in total (avg. speed 7570.9 entries/s)
[2025-09-01 22:41:03,219] INFO: Evaluation class distribution: 
    [(0, 417359), (1, 101809)]
[2025-09-01 22:41:03,294] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:41:04,126] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.999648]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.99523432 0.00476568]
 [0.0192812  0.9807188 ]]
[2025-09-01 22:41:04,129] INFO: [1mEpoch #8: Current validation metric: 0.99239 (best: 0.99239)[0m
[2025-09-01 22:41:04,129] INFO: --------------------------------------------------
[2025-09-01 22:41:04,129] INFO: Epoch #9 training
[2025-09-01 22:41:04,148] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:41:04,160] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:41:52,181] INFO: Processed 199680 entries in total (avg. speed 4155.5 entries/s)
[2025-09-01 22:41:52,182] INFO: Train AvgLoss: 0.02551, AvgAcc: 0.98951
[2025-09-01 22:41:52,182] INFO: Train class distribution: 
    [(0, 8349600), (1, 2033760)]
[2025-09-01 22:41:52,205] INFO: Epoch #9 validating
[2025-09-01 22:41:52,224] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:41:53,488] INFO: Processed 9984 entries in total (avg. speed 7784.3 entries/s)
[2025-09-01 22:41:53,488] INFO: Evaluation class distribution: 
    [(0, 417377), (1, 101791)]
[2025-09-01 22:41:53,570] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:41:54,408] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964666]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99495899 0.00504101]
 [0.01856746 0.98143254]]
[2025-09-01 22:41:54,408] INFO: [1mEpoch #9: Current validation metric: 0.99231 (best: 0.99239)[0m
[2025-09-01 22:41:54,408] INFO: --------------------------------------------------
[2025-09-01 22:41:54,408] INFO: Epoch #10 training
[2025-09-01 22:41:54,425] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:41:54,435] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:42:42,374] INFO: Processed 199680 entries in total (avg. speed 4163.0 entries/s)
[2025-09-01 22:42:42,374] INFO: Train AvgLoss: 0.02548, AvgAcc: 0.98957
[2025-09-01 22:42:42,374] INFO: Train class distribution: 
    [(0, 8349514), (1, 2033846)]
[2025-09-01 22:42:42,390] INFO: Epoch #10 validating
[2025-09-01 22:42:42,410] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:42:43,680] INFO: Processed 9984 entries in total (avg. speed 7743.9 entries/s)
[2025-09-01 22:42:43,680] INFO: Evaluation class distribution: 
    [(0, 417344), (1, 101824)]
[2025-09-01 22:42:43,754] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:42:44,617] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996463]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.9947741  0.0052259 ]
 [0.01805075 0.98194925]]
[2025-09-01 22:42:44,618] INFO: [1mEpoch #10: Current validation metric: 0.99226 (best: 0.99239)[0m
[2025-09-01 22:42:44,618] INFO: --------------------------------------------------
[2025-09-01 22:42:44,618] INFO: Epoch #11 training
[2025-09-01 22:42:44,636] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:42:44,647] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:43:32,801] INFO: Processed 199680 entries in total (avg. speed 4144.2 entries/s)
[2025-09-01 22:43:32,802] INFO: Train AvgLoss: 0.02543, AvgAcc: 0.98954
[2025-09-01 22:43:32,802] INFO: Train class distribution: 
    [(0, 8349568), (1, 2033792)]
[2025-09-01 22:43:32,827] INFO: Epoch #11 validating
[2025-09-01 22:43:32,848] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:43:34,123] INFO: Processed 9984 entries in total (avg. speed 7708.1 entries/s)
[2025-09-01 22:43:34,123] INFO: Evaluation class distribution: 
    [(0, 417346), (1, 101822)]
[2025-09-01 22:43:34,197] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:43:35,042] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996469]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99489153 0.00510847]
 [0.01805111 0.98194889]]
[2025-09-01 22:43:35,043] INFO: [1mEpoch #11: Current validation metric: 0.99235 (best: 0.99239)[0m
[2025-09-01 22:43:35,043] INFO: --------------------------------------------------
[2025-09-01 22:43:35,043] INFO: Epoch #12 training
[2025-09-01 22:43:35,059] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:43:35,070] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:44:23,066] INFO: Processed 199680 entries in total (avg. speed 4158.0 entries/s)
[2025-09-01 22:44:23,066] INFO: Train AvgLoss: 0.02544, AvgAcc: 0.98959
[2025-09-01 22:44:23,066] INFO: Train class distribution: 
    [(0, 8349692), (1, 2033668)]
[2025-09-01 22:44:23,083] INFO: Epoch #12 validating
[2025-09-01 22:44:23,105] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:44:24,375] INFO: Processed 9984 entries in total (avg. speed 7730.9 entries/s)
[2025-09-01 22:44:24,375] INFO: Evaluation class distribution: 
    [(0, 417372), (1, 101796)]
[2025-09-01 22:44:24,450] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:44:25,272] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996473]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99501404 0.00498596]
 [0.01878266 0.98121734]]
[2025-09-01 22:44:25,272] INFO: [1mEpoch #12: Current validation metric: 0.99231 (best: 0.99239)[0m
[2025-09-01 22:44:25,272] INFO: --------------------------------------------------
[2025-09-01 22:44:25,272] INFO: Epoch #13 training
[2025-09-01 22:44:25,290] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:44:25,303] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:45:13,562] INFO: Processed 199680 entries in total (avg. speed 4135.1 entries/s)
[2025-09-01 22:45:13,563] INFO: Train AvgLoss: 0.02541, AvgAcc: 0.98961
[2025-09-01 22:45:13,563] INFO: Train class distribution: 
    [(0, 8349661), (1, 2033699)]
[2025-09-01 22:45:13,580] INFO: Epoch #13 validating
[2025-09-01 22:45:13,600] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:45:14,885] INFO: Processed 9984 entries in total (avg. speed 7657.3 entries/s)
[2025-09-01 22:45:14,885] INFO: Evaluation class distribution: 
    [(0, 417333), (1, 101835)]
[2025-09-01 22:45:14,968] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:45:15,800] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996494]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99515016 0.00484984]
 [0.01878529 0.98121471]]
[2025-09-01 22:45:15,803] INFO: [1mEpoch #13: Current validation metric: 0.99242 (best: 0.99242)[0m
[2025-09-01 22:45:15,803] INFO: --------------------------------------------------
[2025-09-01 22:45:15,803] INFO: Epoch #14 training
[2025-09-01 22:45:15,821] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:45:15,831] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:46:04,121] INFO: Processed 199680 entries in total (avg. speed 4132.6 entries/s)
[2025-09-01 22:46:04,121] INFO: Train AvgLoss: 0.02538, AvgAcc: 0.98958
[2025-09-01 22:46:04,121] INFO: Train class distribution: 
    [(0, 8349637), (1, 2033723)]
[2025-09-01 22:46:04,149] INFO: Epoch #14 validating
[2025-09-01 22:46:04,173] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:46:05,469] INFO: Processed 9984 entries in total (avg. speed 7568.1 entries/s)
[2025-09-01 22:46:05,470] INFO: Evaluation class distribution: 
    [(0, 417331), (1, 101837)]
[2025-09-01 22:46:05,542] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:46:06,362] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964726]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99495365 0.00504635]
 [0.01859835 0.98140165]]
[2025-09-01 22:46:06,362] INFO: [1mEpoch #14: Current validation metric: 0.99230 (best: 0.99242)[0m
[2025-09-01 22:46:06,362] INFO: --------------------------------------------------
[2025-09-01 22:46:06,362] INFO: Epoch #15 training
[2025-09-01 22:46:06,382] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:46:06,395] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:46:54,490] INFO: Processed 199680 entries in total (avg. speed 4148.9 entries/s)
[2025-09-01 22:46:54,491] INFO: Train AvgLoss: 0.02527, AvgAcc: 0.98964
[2025-09-01 22:46:54,491] INFO: Train class distribution: 
    [(0, 8349537), (1, 2033823)]
[2025-09-01 22:46:54,508] INFO: Epoch #15 validating
[2025-09-01 22:46:54,529] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:46:55,802] INFO: Processed 9984 entries in total (avg. speed 7720.5 entries/s)
[2025-09-01 22:46:55,802] INFO: Evaluation class distribution: 
    [(0, 417369), (1, 101799)]
[2025-09-01 22:46:55,881] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:46:56,755] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99965036]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99500442 0.00499558]
 [0.01858564 0.98141436]]
[2025-09-01 22:46:56,755] INFO: [1mEpoch #15: Current validation metric: 0.99234 (best: 0.99242)[0m
[2025-09-01 22:46:56,755] INFO: --------------------------------------------------
[2025-09-01 22:46:56,755] INFO: Epoch #16 training
[2025-09-01 22:46:56,779] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:46:56,791] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:47:45,848] INFO: Processed 199680 entries in total (avg. speed 4067.5 entries/s)
[2025-09-01 22:47:45,849] INFO: Train AvgLoss: 0.02536, AvgAcc: 0.98958
[2025-09-01 22:47:45,849] INFO: Train class distribution: 
    [(0, 8349618), (1, 2033742)]
[2025-09-01 22:47:45,872] INFO: Epoch #16 validating
[2025-09-01 22:47:45,911] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:47:47,260] INFO: Processed 9984 entries in total (avg. speed 7200.4 entries/s)
[2025-09-01 22:47:47,260] INFO: Evaluation class distribution: 
    [(0, 417361), (1, 101807)]
[2025-09-01 22:47:47,348] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:47:48,241] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964976]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99499234 0.00500766]
 [0.0185056  0.9814944 ]]
[2025-09-01 22:47:48,242] INFO: [1mEpoch #16: Current validation metric: 0.99235 (best: 0.99242)[0m
[2025-09-01 22:47:48,242] INFO: --------------------------------------------------
[2025-09-01 22:47:48,242] INFO: Epoch #17 training
[2025-09-01 22:47:48,261] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:47:48,274] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:48:39,304] INFO: Processed 199680 entries in total (avg. speed 3910.6 entries/s)
[2025-09-01 22:48:39,304] INFO: Train AvgLoss: 0.02537, AvgAcc: 0.98958
[2025-09-01 22:48:39,304] INFO: Train class distribution: 
    [(0, 8349612), (1, 2033748)]
[2025-09-01 22:48:39,327] INFO: Epoch #17 validating
[2025-09-01 22:48:39,350] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:48:40,729] INFO: Processed 9984 entries in total (avg. speed 7124.5 entries/s)
[2025-09-01 22:48:40,730] INFO: Evaluation class distribution: 
    [(0, 417362), (1, 101806)]
[2025-09-01 22:48:40,824] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:48:41,736] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9996499]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99510257 0.00489743]
 [0.01872188 0.98127812]]
[2025-09-01 22:48:41,736] INFO: [1mEpoch #17: Current validation metric: 0.99239 (best: 0.99242)[0m
[2025-09-01 22:48:41,736] INFO: --------------------------------------------------
[2025-09-01 22:48:41,736] INFO: Epoch #18 training
[2025-09-01 22:48:41,756] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:48:41,765] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:49:32,643] INFO: Processed 199680 entries in total (avg. speed 3922.5 entries/s)
[2025-09-01 22:49:32,643] INFO: Train AvgLoss: 0.02537, AvgAcc: 0.98959
[2025-09-01 22:49:32,643] INFO: Train class distribution: 
    [(0, 8349661), (1, 2033699)]
[2025-09-01 22:49:32,662] INFO: Epoch #18 validating
[2025-09-01 22:49:32,686] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:49:34,063] INFO: Processed 9984 entries in total (avg. speed 7133.1 entries/s)
[2025-09-01 22:49:34,063] INFO: Evaluation class distribution: 
    [(0, 417366), (1, 101802)]
[2025-09-01 22:49:34,149] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:49:35,070] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99965036]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99503074 0.00496926]
 [0.0185458  0.9814542 ]]
[2025-09-01 22:49:35,070] INFO: [1mEpoch #18: Current validation metric: 0.99237 (best: 0.99242)[0m
[2025-09-01 22:49:35,070] INFO: --------------------------------------------------
[2025-09-01 22:49:35,071] INFO: Epoch #19 training
[2025-09-01 22:49:35,092] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-01 22:49:35,103] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-01 22:50:25,580] INFO: Processed 199680 entries in total (avg. speed 3953.3 entries/s)
[2025-09-01 22:50:25,581] INFO: Train AvgLoss: 0.02536, AvgAcc: 0.98962
[2025-09-01 22:50:25,581] INFO: Train class distribution: 
    [(0, 8349717), (1, 2033643)]
[2025-09-01 22:50:25,602] INFO: Epoch #19 validating
[2025-09-01 22:50:25,624] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-01 22:50:27,032] INFO: Processed 9984 entries in total (avg. speed 6984.6 entries/s)
[2025-09-01 22:50:27,032] INFO: Evaluation class distribution: 
    [(0, 417370), (1, 101798)]
[2025-09-01 22:50:27,120] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-01 22:50:28,059] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99964875]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99500922 0.00499078]
 [0.01851706 0.98148294]]
[2025-09-01 22:50:28,059] INFO: [1mEpoch #19: Current validation metric: 0.99236 (best: 0.99242)[0m
[2025-09-03 00:42:34,090] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', None)
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 0.005)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-03 00:42:34,091] INFO: Running in classification mode
[2025-09-03 00:42:35,168] INFO: Using 2 files for training, range: (0, 1)
[2025-09-03 00:42:35,168] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-03 00:42:35,170] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 00:42:35,170] INFO: [0;37mselection: None[0m
[2025-09-03 00:42:35,170] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 00:42:35,170] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 00:42:35,170] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 00:42:35,170] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 00:42:35,170] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 00:42:35,170] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 00:42:35,170] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 00:42:35,170] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-03 00:42:35,170] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 00:42:35,172] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 00:42:35,172] INFO: [0;37mselection: None[0m
[2025-09-03 00:42:35,172] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 00:42:35,172] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 00:42:35,172] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 00:42:35,172] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 00:42:35,172] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 00:42:35,172] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 00:42:35,172] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 00:42:35,172] INFO: [0;37mobserver_names: ()[0m
[2025-09-03 00:42:35,172] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 00:42:35,174] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 00:42:35,174] INFO: [0;37mselection: None[0m
[2025-09-03 00:42:35,174] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 00:42:35,174] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 00:42:35,174] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 00:42:35,174] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 00:42:35,174] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 00:42:35,174] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 00:42:35,174] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 00:42:35,174] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-03 00:42:35,174] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 00:42:35,176] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 00:42:35,176] INFO: [0;37mselection: None[0m
[2025-09-03 00:42:35,176] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 00:42:35,176] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 00:42:35,176] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 00:42:35,177] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 00:42:35,177] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 00:42:35,177] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 00:42:35,177] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 00:42:35,177] INFO: [0;37mobserver_names: ()[0m
[2025-09-03 00:42:35,177] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 00:42:35,179] INFO: Network options: {}
[2025-09-03 00:42:35,493] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-03 00:42:35,493] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-03 00:42:35,493] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-03 00:42:35,493] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-03 00:42:36,095] INFO: [0;37mParticleNetWrapper(
  |0.118 M, 100.000% Params, 52.65 MMac, 100.000% MACs|
  (fc_out): Sequential(
    |0.008 M, 7.125% Params, 436.138 KMac, 0.828% MACs|
    (0): Linear(in_features=128, out_features=64, bias=True, |0.008 M, 7.014% Params, 426.048 KMac, 0.809% MACs|)
    (1): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
    (2): Linear(in_features=64, out_features=2, bias=True, |0.0 M, 0.110% Params, 6.658 KMac, 0.013% MACs|)
    (3): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 104.0 Mac, 0.000% MACs|)
  )
  (mod): ParticleNet(
    |0.109 M, 92.875% Params, 52.213 MMac, 99.172% MACs|
    (bn_fts): BatchNorm1d(4, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 416.0 Mac, 0.001% MACs|)
    (edge_convs): ModuleList(
      (0): EdgeConvBlock(
        |0.009 M, 8.047% Params, 7.744 MMac, 14.709% MACs|
        (convs): ModuleList(
          (0): Conv2d(8, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.001 M, 0.435% Params, 425.984 KMac, 0.809% MACs|)
          (1-2): 2 x Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 3.480% Params, 3.408 MMac, 6.473% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 106.496 KMac, 0.202% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 53.248 KMac, 0.101% MACs|)
        )
        (sc): Conv1d(4, 64, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 6.656 KMac, 0.013% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 49.588% Params, 42.299 MMac, 80.340% MACs|
        (convs): ModuleList(
          (0-2): 3 x Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 13.919% Params, 13.631 MMac, 25.891% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 212.992 KMac, 0.405% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 106.496 KMac, 0.202% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 6.960% Params, 425.984 KMac, 0.809% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.025 M, 21.097% Params, 1.298 MMac, 2.465% MACs|
      (0): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False, |0.025 M, 20.879% Params, 1.278 MMac, 2.427% MACs|)
      (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
    )
    (fc): Sequential(
      |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
      (0): Sequential(
        |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
        (0): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False, |0.016 M, 13.919% Params, 851.968 KMac, 1.618% MACs|)
        (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
        (3): Dropout(p=0.2, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
    )
  )
)[0m
[2025-09-03 00:42:36,095] INFO: Computational complexity:       52.65 MMac
[2025-09-03 00:42:36,096] INFO: Number of parameters:           117.71 k
[2025-09-03 00:42:36,096] INFO: Using loss function CrossEntropyLoss() with options {}
[2025-09-03 00:42:36,182] INFO: Create Tensorboard summary writer with comment particlemask
[2025-09-03 00:42:36,186] INFO: Optimizer options: {}
[2025-09-03 00:42:37,406] INFO: --------------------------------------------------
[2025-09-03 00:42:37,407] INFO: Epoch #0 training
[2025-09-03 00:42:37,436] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:42:37,436] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:43:23,199] INFO: Processed 199680 entries in total (avg. speed 4360.6 entries/s)
[2025-09-03 00:43:23,199] INFO: Train AvgLoss: 0.10086, AvgAcc: 0.95338
[2025-09-03 00:43:23,200] INFO: Train class distribution: 
    [(0, 8026568), (1, 2356792)]
[2025-09-03 00:43:23,218] INFO: Epoch #0 validating
[2025-09-03 00:43:23,240] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:43:24,509] INFO: Processed 9984 entries in total (avg. speed 7739.2 entries/s)
[2025-09-03 00:43:24,509] INFO: Evaluation class distribution: 
    [(0, 401134), (1, 118034)]
[2025-09-03 00:43:24,569] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:43:25,306] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9995527]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99453051 0.00546949]
 [0.0239592  0.9760408 ]]
[2025-09-03 00:43:25,308] INFO: [1mEpoch #0: Current validation metric: 0.99033 (best: 0.99033)[0m
[2025-09-03 00:43:25,308] INFO: --------------------------------------------------
[2025-09-03 00:43:25,308] INFO: Epoch #1 training
[2025-09-03 00:43:25,324] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:43:25,333] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:44:10,543] INFO: Processed 199680 entries in total (avg. speed 4414.3 entries/s)
[2025-09-03 00:44:10,543] INFO: Train AvgLoss: 0.03295, AvgAcc: 0.98613
[2025-09-03 00:44:10,543] INFO: Train class distribution: 
    [(0, 8026545), (1, 2356815)]
[2025-09-03 00:44:10,559] INFO: Epoch #1 validating
[2025-09-03 00:44:10,578] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:44:11,706] INFO: Processed 9984 entries in total (avg. speed 8706.3 entries/s)
[2025-09-03 00:44:11,706] INFO: Evaluation class distribution: 
    [(0, 401109), (1, 118059)]
[2025-09-03 00:44:11,766] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:44:12,629] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.999828]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.99605344 0.00394656]
 [0.01032535 0.98967465]]
[2025-09-03 00:44:12,632] INFO: [1mEpoch #1: Current validation metric: 0.99460 (best: 0.99460)[0m
[2025-09-03 00:44:12,632] INFO: --------------------------------------------------
[2025-09-03 00:44:12,632] INFO: Epoch #2 training
[2025-09-03 00:44:12,649] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:44:12,658] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:44:57,735] INFO: Processed 199680 entries in total (avg. speed 4427.3 entries/s)
[2025-09-03 00:44:57,735] INFO: Train AvgLoss: 0.02719, AvgAcc: 0.98855
[2025-09-03 00:44:57,735] INFO: Train class distribution: 
    [(0, 8026646), (1, 2356714)]
[2025-09-03 00:44:57,750] INFO: Epoch #2 validating
[2025-09-03 00:44:57,767] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:44:58,897] INFO: Processed 9984 entries in total (avg. speed 8704.1 entries/s)
[2025-09-03 00:44:58,897] INFO: Evaluation class distribution: 
    [(0, 401091), (1, 118077)]
[2025-09-03 00:44:58,959] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:44:59,771] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99987644]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99579647 0.00420353]
 [0.00657198 0.99342802]]
[2025-09-03 00:44:59,772] INFO: [1mEpoch #2: Current validation metric: 0.99526 (best: 0.99526)[0m
[2025-09-03 00:44:59,772] INFO: --------------------------------------------------
[2025-09-03 00:44:59,772] INFO: Epoch #3 training
[2025-09-03 00:44:59,788] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:44:59,799] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:45:45,215] INFO: Processed 199680 entries in total (avg. speed 4394.2 entries/s)
[2025-09-03 00:45:45,215] INFO: Train AvgLoss: 0.02492, AvgAcc: 0.98956
[2025-09-03 00:45:45,215] INFO: Train class distribution: 
    [(0, 8026508), (1, 2356852)]
[2025-09-03 00:45:45,231] INFO: Epoch #3 validating
[2025-09-03 00:45:45,250] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:45:46,375] INFO: Processed 9984 entries in total (avg. speed 8735.0 entries/s)
[2025-09-03 00:45:46,375] INFO: Evaluation class distribution: 
    [(0, 401127), (1, 118041)]
[2025-09-03 00:45:46,436] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:45:47,263] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99990326]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99630042 0.00369958]
 [0.00523547 0.99476453]]
[2025-09-03 00:45:47,267] INFO: [1mEpoch #3: Current validation metric: 0.99595 (best: 0.99595)[0m
[2025-09-03 00:45:47,267] INFO: --------------------------------------------------
[2025-09-03 00:45:47,267] INFO: Epoch #4 training
[2025-09-03 00:45:47,283] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:45:47,292] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:46:32,850] INFO: Processed 199680 entries in total (avg. speed 4380.6 entries/s)
[2025-09-03 00:46:32,850] INFO: Train AvgLoss: 0.02342, AvgAcc: 0.99019
[2025-09-03 00:46:32,850] INFO: Train class distribution: 
    [(0, 8026621), (1, 2356739)]
[2025-09-03 00:46:32,866] INFO: Epoch #4 validating
[2025-09-03 00:46:32,885] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:46:34,054] INFO: Processed 9984 entries in total (avg. speed 8405.3 entries/s)
[2025-09-03 00:46:34,054] INFO: Evaluation class distribution: 
    [(0, 401124), (1, 118044)]
[2025-09-03 00:46:34,118] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:46:34,952] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999231]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99678404 0.00321596]
 [0.00511674 0.99488326]]
[2025-09-03 00:46:34,953] INFO: [1mEpoch #4: Current validation metric: 0.99635 (best: 0.99635)[0m
[2025-09-03 00:46:34,953] INFO: --------------------------------------------------
[2025-09-03 00:46:34,953] INFO: Epoch #5 training
[2025-09-03 00:46:34,970] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:46:34,979] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:47:21,297] INFO: Processed 199680 entries in total (avg. speed 4308.7 entries/s)
[2025-09-03 00:47:21,297] INFO: Train AvgLoss: 0.02238, AvgAcc: 0.99065
[2025-09-03 00:47:21,297] INFO: Train class distribution: 
    [(0, 8026606), (1, 2356754)]
[2025-09-03 00:47:21,315] INFO: Epoch #5 validating
[2025-09-03 00:47:21,333] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:47:22,457] INFO: Processed 9984 entries in total (avg. speed 8744.1 entries/s)
[2025-09-03 00:47:22,458] INFO: Evaluation class distribution: 
    [(0, 401106), (1, 118062)]
[2025-09-03 00:47:22,518] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:47:23,326] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999308]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.9966019 0.0033981]
 [0.0045654 0.9954346]]
[2025-09-03 00:47:23,327] INFO: [1mEpoch #5: Current validation metric: 0.99634 (best: 0.99635)[0m
[2025-09-03 00:47:23,327] INFO: --------------------------------------------------
[2025-09-03 00:47:23,327] INFO: Epoch #6 training
[2025-09-03 00:47:23,344] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:47:23,353] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:48:09,470] INFO: Processed 199680 entries in total (avg. speed 4327.4 entries/s)
[2025-09-03 00:48:09,471] INFO: Train AvgLoss: 0.02158, AvgAcc: 0.99103
[2025-09-03 00:48:09,471] INFO: Train class distribution: 
    [(0, 8026568), (1, 2356792)]
[2025-09-03 00:48:09,487] INFO: Epoch #6 validating
[2025-09-03 00:48:09,504] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:48:10,652] INFO: Processed 9984 entries in total (avg. speed 8566.9 entries/s)
[2025-09-03 00:48:10,653] INFO: Evaluation class distribution: 
    [(0, 401130), (1, 118038)]
[2025-09-03 00:48:10,712] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:48:11,537] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99993247]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99727769 0.00272231]
 [0.00594724 0.99405276]]
[2025-09-03 00:48:11,539] INFO: [1mEpoch #6: Current validation metric: 0.99654 (best: 0.99654)[0m
[2025-09-03 00:48:11,539] INFO: --------------------------------------------------
[2025-09-03 00:48:11,539] INFO: Epoch #7 training
[2025-09-03 00:48:11,558] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:48:11,566] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:48:58,019] INFO: Processed 199680 entries in total (avg. speed 4296.0 entries/s)
[2025-09-03 00:48:58,020] INFO: Train AvgLoss: 0.02097, AvgAcc: 0.99128
[2025-09-03 00:48:58,020] INFO: Train class distribution: 
    [(0, 8026593), (1, 2356767)]
[2025-09-03 00:48:58,034] INFO: Epoch #7 validating
[2025-09-03 00:48:58,051] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:48:59,208] INFO: Processed 9984 entries in total (avg. speed 8506.6 entries/s)
[2025-09-03 00:48:59,208] INFO: Evaluation class distribution: 
    [(0, 401118), (1, 118050)]
[2025-09-03 00:48:59,270] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:49:00,101] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99994177]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99716542 0.00283458]
 [0.00433715 0.99566285]]
[2025-09-03 00:49:00,102] INFO: [1mEpoch #7: Current validation metric: 0.99682 (best: 0.99682)[0m
[2025-09-03 00:49:00,102] INFO: --------------------------------------------------
[2025-09-03 00:49:00,102] INFO: Epoch #8 training
[2025-09-03 00:49:00,119] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:49:00,129] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:49:46,350] INFO: Processed 199680 entries in total (avg. speed 4317.7 entries/s)
[2025-09-03 00:49:46,350] INFO: Train AvgLoss: 0.02038, AvgAcc: 0.99154
[2025-09-03 00:49:46,350] INFO: Train class distribution: 
    [(0, 8026496), (1, 2356864)]
[2025-09-03 00:49:46,364] INFO: Epoch #8 validating
[2025-09-03 00:49:46,381] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:49:47,531] INFO: Processed 9984 entries in total (avg. speed 8562.8 entries/s)
[2025-09-03 00:49:47,531] INFO: Evaluation class distribution: 
    [(0, 401126), (1, 118042)]
[2025-09-03 00:49:47,588] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:49:48,430] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999397]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99714055 0.00285945]
 [0.00438827 0.99561173]]
[2025-09-03 00:49:48,431] INFO: [1mEpoch #8: Current validation metric: 0.99679 (best: 0.99682)[0m
[2025-09-03 00:49:48,431] INFO: --------------------------------------------------
[2025-09-03 00:49:48,431] INFO: Epoch #9 training
[2025-09-03 00:49:48,448] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:49:48,459] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:50:34,080] INFO: Processed 199680 entries in total (avg. speed 4374.2 entries/s)
[2025-09-03 00:50:34,081] INFO: Train AvgLoss: 0.02001, AvgAcc: 0.99175
[2025-09-03 00:50:34,081] INFO: Train class distribution: 
    [(0, 8026516), (1, 2356844)]
[2025-09-03 00:50:34,096] INFO: Epoch #9 validating
[2025-09-03 00:50:34,114] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:50:35,292] INFO: Processed 9984 entries in total (avg. speed 8354.4 entries/s)
[2025-09-03 00:50:35,292] INFO: Evaluation class distribution: 
    [(0, 401141), (1, 118027)]
[2025-09-03 00:50:35,352] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:50:36,171] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99994683]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99719051 0.00280949]
 [0.00362629 0.99637371]]
[2025-09-03 00:50:36,172] INFO: [1mEpoch #9: Current validation metric: 0.99700 (best: 0.99700)[0m
[2025-09-03 00:50:36,172] INFO: --------------------------------------------------
[2025-09-03 00:50:36,172] INFO: Epoch #10 training
[2025-09-03 00:50:36,189] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:50:36,203] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:51:21,717] INFO: Processed 199680 entries in total (avg. speed 4384.2 entries/s)
[2025-09-03 00:51:21,718] INFO: Train AvgLoss: 0.01974, AvgAcc: 0.99183
[2025-09-03 00:51:21,718] INFO: Train class distribution: 
    [(0, 8026649), (1, 2356711)]
[2025-09-03 00:51:21,732] INFO: Epoch #10 validating
[2025-09-03 00:51:21,753] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:51:22,898] INFO: Processed 9984 entries in total (avg. speed 8564.3 entries/s)
[2025-09-03 00:51:22,899] INFO: Evaluation class distribution: 
    [(0, 401125), (1, 118043)]
[2025-09-03 00:51:22,955] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:51:23,761] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999471]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99770645 0.00229355]
 [0.00513372 0.99486628]]
[2025-09-03 00:51:23,763] INFO: [1mEpoch #10: Current validation metric: 0.99706 (best: 0.99706)[0m
[2025-09-03 00:51:23,764] INFO: --------------------------------------------------
[2025-09-03 00:51:23,764] INFO: Epoch #11 training
[2025-09-03 00:51:23,781] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:51:23,789] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:52:09,212] INFO: Processed 199680 entries in total (avg. speed 4393.6 entries/s)
[2025-09-03 00:52:09,213] INFO: Train AvgLoss: 0.01941, AvgAcc: 0.99196
[2025-09-03 00:52:09,213] INFO: Train class distribution: 
    [(0, 8026704), (1, 2356656)]
[2025-09-03 00:52:09,233] INFO: Epoch #11 validating
[2025-09-03 00:52:09,252] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:52:10,355] INFO: Processed 9984 entries in total (avg. speed 8902.8 entries/s)
[2025-09-03 00:52:10,356] INFO: Evaluation class distribution: 
    [(0, 401108), (1, 118060)]
[2025-09-03 00:52:10,416] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:52:11,221] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99995065]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99735233 0.00264767]
 [0.00388785 0.99611215]]
[2025-09-03 00:52:11,224] INFO: [1mEpoch #11: Current validation metric: 0.99707 (best: 0.99707)[0m
[2025-09-03 00:52:11,224] INFO: --------------------------------------------------
[2025-09-03 00:52:11,224] INFO: Epoch #12 training
[2025-09-03 00:52:11,241] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:52:11,251] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:52:56,288] INFO: Processed 199680 entries in total (avg. speed 4431.1 entries/s)
[2025-09-03 00:52:56,288] INFO: Train AvgLoss: 0.01922, AvgAcc: 0.99205
[2025-09-03 00:52:56,288] INFO: Train class distribution: 
    [(0, 8026529), (1, 2356831)]
[2025-09-03 00:52:56,305] INFO: Epoch #12 validating
[2025-09-03 00:52:56,324] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:52:57,449] INFO: Processed 9984 entries in total (avg. speed 8729.2 entries/s)
[2025-09-03 00:52:57,450] INFO: Evaluation class distribution: 
    [(0, 401112), (1, 118056)]
[2025-09-03 00:52:57,510] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:52:58,328] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999544]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99770388 0.00229612]
 [0.00407434 0.99592566]]
[2025-09-03 00:52:58,331] INFO: [1mEpoch #12: Current validation metric: 0.99730 (best: 0.99730)[0m
[2025-09-03 00:52:58,331] INFO: --------------------------------------------------
[2025-09-03 00:52:58,331] INFO: Epoch #13 training
[2025-09-03 00:52:58,348] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:52:58,360] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:53:43,914] INFO: Processed 199680 entries in total (avg. speed 4380.6 entries/s)
[2025-09-03 00:53:43,914] INFO: Train AvgLoss: 0.01902, AvgAcc: 0.99214
[2025-09-03 00:53:43,914] INFO: Train class distribution: 
    [(0, 8026620), (1, 2356740)]
[2025-09-03 00:53:43,929] INFO: Epoch #13 validating
[2025-09-03 00:53:43,947] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:53:45,071] INFO: Processed 9984 entries in total (avg. speed 8748.0 entries/s)
[2025-09-03 00:53:45,071] INFO: Evaluation class distribution: 
    [(0, 401106), (1, 118062)]
[2025-09-03 00:53:45,131] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:53:45,925] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999541]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99754678 0.00245322]
 [0.00392167 0.99607833]]
[2025-09-03 00:53:45,925] INFO: [1mEpoch #13: Current validation metric: 0.99721 (best: 0.99730)[0m
[2025-09-03 00:53:45,925] INFO: --------------------------------------------------
[2025-09-03 00:53:45,925] INFO: Epoch #14 training
[2025-09-03 00:53:45,941] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:53:45,951] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:54:31,149] INFO: Processed 199680 entries in total (avg. speed 4415.5 entries/s)
[2025-09-03 00:54:31,149] INFO: Train AvgLoss: 0.01810, AvgAcc: 0.99256
[2025-09-03 00:54:31,149] INFO: Train class distribution: 
    [(0, 8026704), (1, 2356656)]
[2025-09-03 00:54:31,168] INFO: Epoch #14 validating
[2025-09-03 00:54:31,189] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:54:32,357] INFO: Processed 9984 entries in total (avg. speed 8403.5 entries/s)
[2025-09-03 00:54:32,357] INFO: Evaluation class distribution: 
    [(0, 401126), (1, 118042)]
[2025-09-03 00:54:32,417] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:54:33,226] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999577]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99762419 0.00237581]
 [0.00385456 0.99614544]]
[2025-09-03 00:54:33,226] INFO: [1mEpoch #14: Current validation metric: 0.99729 (best: 0.99730)[0m
[2025-09-03 00:54:33,226] INFO: --------------------------------------------------
[2025-09-03 00:54:33,226] INFO: Epoch #15 training
[2025-09-03 00:54:33,246] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:54:33,254] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:55:18,790] INFO: Processed 199680 entries in total (avg. speed 4382.5 entries/s)
[2025-09-03 00:55:18,790] INFO: Train AvgLoss: 0.01759, AvgAcc: 0.99276
[2025-09-03 00:55:18,790] INFO: Train class distribution: 
    [(0, 8026561), (1, 2356799)]
[2025-09-03 00:55:18,805] INFO: Epoch #15 validating
[2025-09-03 00:55:18,822] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:55:19,946] INFO: Processed 9984 entries in total (avg. speed 8758.2 entries/s)
[2025-09-03 00:55:19,946] INFO: Evaluation class distribution: 
    [(0, 401132), (1, 118036)]
[2025-09-03 00:55:20,006] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:55:20,787] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999642]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99787601 0.00212399]
 [0.00367684 0.99632316]]
[2025-09-03 00:55:20,789] INFO: [1mEpoch #15: Current validation metric: 0.99752 (best: 0.99752)[0m
[2025-09-03 00:55:20,789] INFO: --------------------------------------------------
[2025-09-03 00:55:20,789] INFO: Epoch #16 training
[2025-09-03 00:55:20,805] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:55:20,814] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:56:06,111] INFO: Processed 199680 entries in total (avg. speed 4405.8 entries/s)
[2025-09-03 00:56:06,112] INFO: Train AvgLoss: 0.01727, AvgAcc: 0.99291
[2025-09-03 00:56:06,112] INFO: Train class distribution: 
    [(0, 8026485), (1, 2356875)]
[2025-09-03 00:56:06,129] INFO: Epoch #16 validating
[2025-09-03 00:56:06,147] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:56:07,291] INFO: Processed 9984 entries in total (avg. speed 8595.7 entries/s)
[2025-09-03 00:56:07,292] INFO: Evaluation class distribution: 
    [(0, 401126), (1, 118042)]
[2025-09-03 00:56:07,349] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:56:08,132] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999668]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99816018 0.00183982]
 [0.00423578 0.99576422]]
[2025-09-03 00:56:08,133] INFO: [1mEpoch #16: Current validation metric: 0.99762 (best: 0.99762)[0m
[2025-09-03 00:56:08,133] INFO: --------------------------------------------------
[2025-09-03 00:56:08,133] INFO: Epoch #17 training
[2025-09-03 00:56:08,152] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:56:08,160] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:56:53,591] INFO: Processed 199680 entries in total (avg. speed 4392.7 entries/s)
[2025-09-03 00:56:53,591] INFO: Train AvgLoss: 0.01710, AvgAcc: 0.99298
[2025-09-03 00:56:53,591] INFO: Train class distribution: 
    [(0, 8026514), (1, 2356846)]
[2025-09-03 00:56:53,605] INFO: Epoch #17 validating
[2025-09-03 00:56:53,624] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:56:54,755] INFO: Processed 9984 entries in total (avg. speed 8687.1 entries/s)
[2025-09-03 00:56:54,755] INFO: Evaluation class distribution: 
    [(0, 401116), (1, 118052)]
[2025-09-03 00:56:54,815] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:56:55,598] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999671]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99810279 0.00189721]
 [0.00387965 0.99612035]]
[2025-09-03 00:56:55,599] INFO: [1mEpoch #17: Current validation metric: 0.99765 (best: 0.99765)[0m
[2025-09-03 00:56:55,599] INFO: --------------------------------------------------
[2025-09-03 00:56:55,599] INFO: Epoch #18 training
[2025-09-03 00:56:55,617] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:56:55,631] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:57:40,814] INFO: Processed 199680 entries in total (avg. speed 4416.3 entries/s)
[2025-09-03 00:57:40,814] INFO: Train AvgLoss: 0.01708, AvgAcc: 0.99300
[2025-09-03 00:57:40,814] INFO: Train class distribution: 
    [(0, 8026507), (1, 2356853)]
[2025-09-03 00:57:40,829] INFO: Epoch #18 validating
[2025-09-03 00:57:40,847] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:57:42,018] INFO: Processed 9984 entries in total (avg. speed 8396.7 entries/s)
[2025-09-03 00:57:42,019] INFO: Evaluation class distribution: 
    [(0, 401110), (1, 118058)]
[2025-09-03 00:57:42,082] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:57:42,881] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999673]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99811772 0.00188228]
 [0.00396415 0.99603585]]
[2025-09-03 00:57:42,881] INFO: [1mEpoch #18: Current validation metric: 0.99764 (best: 0.99765)[0m
[2025-09-03 00:57:42,881] INFO: --------------------------------------------------
[2025-09-03 00:57:42,881] INFO: Epoch #19 training
[2025-09-03 00:57:42,900] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 00:57:42,909] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 00:58:28,680] INFO: Processed 199680 entries in total (avg. speed 4360.0 entries/s)
[2025-09-03 00:58:28,680] INFO: Train AvgLoss: 0.01709, AvgAcc: 0.99301
[2025-09-03 00:58:28,680] INFO: Train class distribution: 
    [(0, 8026625), (1, 2356735)]
[2025-09-03 00:58:28,697] INFO: Epoch #19 validating
[2025-09-03 00:58:28,717] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 00:58:29,960] INFO: Processed 9984 entries in total (avg. speed 7905.5 entries/s)
[2025-09-03 00:58:29,961] INFO: Evaluation class distribution: 
    [(0, 401124), (1, 118044)]
[2025-09-03 00:58:30,022] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 00:58:30,858] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999676]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.9980779  0.0019221 ]
 [0.00381214 0.99618786]]
[2025-09-03 00:58:30,859] INFO: [1mEpoch #19: Current validation metric: 0.99765 (best: 0.99765)[0m
[2025-09-03 01:15:13,216] INFO: args:
 - ('regression_mode', False)
 - ('data_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/data_config_mask.yaml')
 - ('extra_selection', None)
 - ('extra_test_selection', None)
 - ('data_train', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train*.root'])
 - ('data_val', ['/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root'])
 - ('data_test', [])
 - ('data_fraction', 1)
 - ('file_fraction', 1)
 - ('fetch_by_files', True)
 - ('fetch_step', 1.0)
 - ('in_memory', False)
 - ('train_val_split', 0.8)
 - ('no_remake_weights', False)
 - ('demo', False)
 - ('lr_finder', None)
 - ('tensorboard', 'particlemask')
 - ('tensorboard_custom_fn', None)
 - ('network_config', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/config/particlenet_pf_mask.py')
 - ('network_option', [])
 - ('model_prefix', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask')
 - ('load_model_weights', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask_complete_with_eta_phi.pt')
 - ('exclude_model_weights', None)
 - ('freeze_model_weights', None)
 - ('num_epochs', 20)
 - ('steps_per_epoch', None)
 - ('steps_per_epoch_val', None)
 - ('samples_per_epoch', None)
 - ('samples_per_epoch_val', None)
 - ('optimizer', 'ranger')
 - ('optimizer_option', [])
 - ('lr_scheduler', 'flat+decay')
 - ('warmup_steps', 0)
 - ('load_epoch', None)
 - ('start_lr', 5e-05)
 - ('batch_size', 256)
 - ('use_amp', False)
 - ('gpus', '0')
 - ('predict_gpus', '0')
 - ('num_workers', 2)
 - ('predict', False)
 - ('predict_output', None)
 - ('export_onnx', None)
 - ('onnx_opset', 15)
 - ('io_test', False)
 - ('copy_inputs', False)
 - ('log', '/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask.train.log')
 - ('print', False)
 - ('profile', False)
 - ('backend', None)
 - ('cross_validation', None)
 - ('local_rank', None)
[2025-09-03 01:15:13,217] INFO: Running in classification mode
[2025-09-03 01:15:14,286] INFO: Using 2 files for training, range: (0, 1)
[2025-09-03 01:15:14,286] INFO: Using 1 files for validation, range: (0, 1)
[2025-09-03 01:15:14,289] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 01:15:14,289] INFO: [0;37mselection: None[0m
[2025-09-03 01:15:14,289] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 01:15:14,289] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 01:15:14,289] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 01:15:14,289] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 01:15:14,289] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 01:15:14,289] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 01:15:14,289] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 01:15:14,289] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-03 01:15:14,289] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 01:15:14,291] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 01:15:14,291] INFO: [0;37mselection: None[0m
[2025-09-03 01:15:14,291] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 01:15:14,291] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 01:15:14,291] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 01:15:14,291] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 01:15:14,291] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 01:15:14,291] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 01:15:14,292] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 01:15:14,292] INFO: [0;37mobserver_names: ()[0m
[2025-09-03 01:15:14,292] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 01:15:14,293] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 01:15:14,293] INFO: [0;37mselection: None[0m
[2025-09-03 01:15:14,293] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 01:15:14,294] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 01:15:14,294] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 01:15:14,294] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 01:15:14,294] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 01:15:14,294] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 01:15:14,294] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 01:15:14,294] INFO: [0;37mobserver_names: ('pdg_id',)[0m
[2025-09-03 01:15:14,294] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 01:15:14,296] INFO: [0;37mpreprocess config: {'method': 'manual', 'data_fraction': 1.0, 'params': None}[0m
[2025-09-03 01:15:14,297] INFO: [0;37mselection: None[0m
[2025-09-03 01:15:14,297] INFO: [0;37mtest_time_selection: None[0m
[2025-09-03 01:15:14,297] INFO: [0;37mvar_funcs:
 - ('pf_mask', 'awkward.ones_like(Part_E)')
 - ('not_mask', '1 - Part_mask')
 - ('_label_', 'np.stack([ak.to_numpy(Part_mask)], axis=1)')
 - ('_labelcheck_', 'np.sum(np.stack([ak.to_numpy(Part_mask)], axis=1), axis=1)')[0m
[2025-09-03 01:15:14,297] INFO: [0;37minput_names: ('pf_points', 'pf_features', 'pf_mask')[0m
[2025-09-03 01:15:14,297] INFO: [0;37minput_dicts:
 - ('pf_points', ['Part_eta', 'Part_phi'])
 - ('pf_features', ['Part_E', 'Part_px', 'Part_py', 'Part_pz'])
 - ('pf_mask', ['pf_mask'])[0m
[2025-09-03 01:15:14,297] INFO: [0;37minput_shapes:
 - ('pf_points', (-1, 2, 52))
 - ('pf_features', (-1, 4, 52))
 - ('pf_mask', (-1, 1, 52))[0m
[2025-09-03 01:15:14,297] INFO: [0;37mpreprocess_params:
 - ('Part_eta', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_phi', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -10, 'max': 10, 'pad_value': 0})
 - ('Part_E', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_px', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_py', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('Part_pz', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})
 - ('pf_mask', {'length': 52, 'pad_mode': 'constant', 'center': None, 'scale': 1, 'min': -5, 'max': 5, 'pad_value': 0})[0m
[2025-09-03 01:15:14,297] INFO: [0;37mlabel_names: ('_label_',)[0m
[2025-09-03 01:15:14,297] INFO: [0;37mobserver_names: ()[0m
[2025-09-03 01:15:14,297] INFO: [0;37mmonitor_variables: ()[0m
[2025-09-03 01:15:14,300] INFO: Network options: {}
[2025-09-03 01:15:14,344] INFO: Model initialized with weights from /home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/training_log/particlemask_complete_with_eta_phi.pt
 ... Missing: []
 ... Unexpected: []
[2025-09-03 01:15:14,576] INFO: [0;37mWarning: module EdgeConvBlock is treated as a zero-op.[0m
[2025-09-03 01:15:14,576] INFO: [0;37mWarning: module Dropout is treated as a zero-op.[0m
[2025-09-03 01:15:14,576] INFO: [0;37mWarning: module ParticleNet is treated as a zero-op.[0m
[2025-09-03 01:15:14,576] INFO: [0;37mWarning: module ParticleNetWrapper is treated as a zero-op.[0m
[2025-09-03 01:15:15,171] INFO: [0;37mParticleNetWrapper(
  |0.118 M, 100.000% Params, 52.65 MMac, 100.000% MACs|
  (fc_out): Sequential(
    |0.008 M, 7.125% Params, 436.138 KMac, 0.828% MACs|
    (0): Linear(in_features=128, out_features=64, bias=True, |0.008 M, 7.014% Params, 426.048 KMac, 0.809% MACs|)
    (1): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
    (2): Linear(in_features=64, out_features=2, bias=True, |0.0 M, 0.110% Params, 6.658 KMac, 0.013% MACs|)
    (3): LeakyReLU(negative_slope=0.01, |0.0 M, 0.000% Params, 104.0 Mac, 0.000% MACs|)
  )
  (mod): ParticleNet(
    |0.109 M, 92.875% Params, 52.213 MMac, 99.172% MACs|
    (bn_fts): BatchNorm1d(4, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.007% Params, 416.0 Mac, 0.001% MACs|)
    (edge_convs): ModuleList(
      (0): EdgeConvBlock(
        |0.009 M, 8.047% Params, 7.744 MMac, 14.709% MACs|
        (convs): ModuleList(
          (0): Conv2d(8, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.001 M, 0.435% Params, 425.984 KMac, 0.809% MACs|)
          (1-2): 2 x Conv2d(64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.004 M, 3.480% Params, 3.408 MMac, 6.473% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 106.496 KMac, 0.202% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 53.248 KMac, 0.101% MACs|)
        )
        (sc): Conv1d(4, 64, kernel_size=(1,), stride=(1,), bias=False, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_bn): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.109% Params, 6.656 KMac, 0.013% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 3.328 KMac, 0.006% MACs|)
      )
      (1): EdgeConvBlock(
        |0.058 M, 49.588% Params, 42.299 MMac, 80.340% MACs|
        (convs): ModuleList(
          (0-2): 3 x Conv2d(128, 128, kernel_size=(1, 1), stride=(1, 1), bias=False, |0.016 M, 13.919% Params, 13.631 MMac, 25.891% MACs|)
        )
        (bns): ModuleList(
          (0-2): 3 x BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 212.992 KMac, 0.405% MACs|)
        )
        (acts): ModuleList(
          (0-2): 3 x ReLU(|0.0 M, 0.000% Params, 106.496 KMac, 0.202% MACs|)
        )
        (sc): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False, |0.008 M, 6.960% Params, 425.984 KMac, 0.809% MACs|)
        (sc_bn): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (sc_act): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
      )
    )
    (fusion_block): Sequential(
      |0.025 M, 21.097% Params, 1.298 MMac, 2.465% MACs|
      (0): Conv1d(192, 128, kernel_size=(1,), stride=(1,), bias=False, |0.025 M, 20.879% Params, 1.278 MMac, 2.427% MACs|)
      (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
      (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
    )
    (fc): Sequential(
      |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
      (0): Sequential(
        |0.017 M, 14.137% Params, 871.936 KMac, 1.656% MACs|
        (0): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False, |0.016 M, 13.919% Params, 851.968 KMac, 1.618% MACs|)
        (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, |0.0 M, 0.217% Params, 13.312 KMac, 0.025% MACs|)
        (2): ReLU(|0.0 M, 0.000% Params, 6.656 KMac, 0.013% MACs|)
        (3): Dropout(p=0.2, inplace=False, |0.0 M, 0.000% Params, 0.0 Mac, 0.000% MACs|)
      )
    )
  )
)[0m
[2025-09-03 01:15:15,172] INFO: Computational complexity:       52.65 MMac
[2025-09-03 01:15:15,172] INFO: Number of parameters:           117.71 k
[2025-09-03 01:15:15,172] INFO: Using loss function CrossEntropyLoss() with options {}
[2025-09-03 01:15:15,217] INFO: Create Tensorboard summary writer with comment particlemask
[2025-09-03 01:15:15,221] INFO: Optimizer options: {}
[2025-09-03 01:15:16,409] INFO: --------------------------------------------------
[2025-09-03 01:15:16,409] INFO: Epoch #0 training
[2025-09-03 01:15:16,448] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:15:16,449] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:16:02,504] INFO: Processed 199680 entries in total (avg. speed 4332.0 entries/s)
[2025-09-03 01:16:02,504] INFO: Train AvgLoss: 0.01702, AvgAcc: 0.99301
[2025-09-03 01:16:02,504] INFO: Train class distribution: 
    [(0, 8026569), (1, 2356791)]
[2025-09-03 01:16:02,518] INFO: Epoch #0 validating
[2025-09-03 01:16:02,539] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:16:03,891] INFO: Processed 9984 entries in total (avg. speed 7275.6 entries/s)
[2025-09-03 01:16:03,891] INFO: Evaluation class distribution: 
    [(0, 401120), (1, 118048)]
[2025-09-03 01:16:03,957] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:16:04,678] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999673]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99801057 0.00198943]
 [0.00373577 0.99626423]]
[2025-09-03 01:16:04,679] INFO: [1mEpoch #0: Current validation metric: 0.99761 (best: 0.99761)[0m
[2025-09-03 01:16:04,679] INFO: --------------------------------------------------
[2025-09-03 01:16:04,679] INFO: Epoch #1 training
[2025-09-03 01:16:04,695] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:16:04,705] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:16:52,419] INFO: Processed 199680 entries in total (avg. speed 4182.7 entries/s)
[2025-09-03 01:16:52,419] INFO: Train AvgLoss: 0.01716, AvgAcc: 0.99293
[2025-09-03 01:16:52,419] INFO: Train class distribution: 
    [(0, 8026417), (1, 2356943)]
[2025-09-03 01:16:52,434] INFO: Epoch #1 validating
[2025-09-03 01:16:52,455] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:16:53,697] INFO: Processed 9984 entries in total (avg. speed 7911.3 entries/s)
[2025-09-03 01:16:53,697] INFO: Evaluation class distribution: 
    [(0, 401132), (1, 118036)]
[2025-09-03 01:16:53,763] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:16:54,597] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999677]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99807545 0.00192455]
 [0.00377851 0.99622149]]
[2025-09-03 01:16:54,599] INFO: [1mEpoch #1: Current validation metric: 0.99765 (best: 0.99765)[0m
[2025-09-03 01:16:54,599] INFO: --------------------------------------------------
[2025-09-03 01:16:54,599] INFO: Epoch #2 training
[2025-09-03 01:16:54,617] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:16:54,628] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:17:42,598] INFO: Processed 199680 entries in total (avg. speed 4160.1 entries/s)
[2025-09-03 01:17:42,599] INFO: Train AvgLoss: 0.01703, AvgAcc: 0.99304
[2025-09-03 01:17:42,599] INFO: Train class distribution: 
    [(0, 8026504), (1, 2356856)]
[2025-09-03 01:17:42,615] INFO: Epoch #2 validating
[2025-09-03 01:17:42,634] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:17:43,901] INFO: Processed 9984 entries in total (avg. speed 7766.2 entries/s)
[2025-09-03 01:17:43,901] INFO: Evaluation class distribution: 
    [(0, 401122), (1, 118046)]
[2025-09-03 01:17:43,966] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:17:44,792] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99996823]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99797568 0.00202432]
 [0.00346475 0.99653525]]
[2025-09-03 01:17:44,793] INFO: [1mEpoch #2: Current validation metric: 0.99765 (best: 0.99765)[0m
[2025-09-03 01:17:44,793] INFO: --------------------------------------------------
[2025-09-03 01:17:44,793] INFO: Epoch #3 training
[2025-09-03 01:17:44,810] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:17:44,819] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:18:33,454] INFO: Processed 199680 entries in total (avg. speed 4103.5 entries/s)
[2025-09-03 01:18:33,454] INFO: Train AvgLoss: 0.01703, AvgAcc: 0.99301
[2025-09-03 01:18:33,454] INFO: Train class distribution: 
    [(0, 8026591), (1, 2356769)]
[2025-09-03 01:18:33,472] INFO: Epoch #3 validating
[2025-09-03 01:18:33,494] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:18:34,762] INFO: Processed 9984 entries in total (avg. speed 7744.4 entries/s)
[2025-09-03 01:18:34,762] INFO: Evaluation class distribution: 
    [(0, 401123), (1, 118045)]
[2025-09-03 01:18:34,826] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:18:35,663] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999676]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99802804 0.00197196]
 [0.00370198 0.99629802]]
[2025-09-03 01:18:35,663] INFO: [1mEpoch #3: Current validation metric: 0.99763 (best: 0.99765)[0m
[2025-09-03 01:18:35,663] INFO: --------------------------------------------------
[2025-09-03 01:18:35,663] INFO: Epoch #4 training
[2025-09-03 01:18:35,681] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:18:35,692] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:19:24,984] INFO: Processed 199680 entries in total (avg. speed 4048.6 entries/s)
[2025-09-03 01:19:24,985] INFO: Train AvgLoss: 0.01698, AvgAcc: 0.99303
[2025-09-03 01:19:24,985] INFO: Train class distribution: 
    [(0, 8026655), (1, 2356705)]
[2025-09-03 01:19:25,007] INFO: Epoch #4 validating
[2025-09-03 01:19:25,030] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:19:26,297] INFO: Processed 9984 entries in total (avg. speed 7744.0 entries/s)
[2025-09-03 01:19:26,297] INFO: Evaluation class distribution: 
    [(0, 401104), (1, 118064)]
[2025-09-03 01:19:26,367] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:19:27,273] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99996704]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99793071 0.00206929]
 [0.00359974 0.99640026]]
[2025-09-03 01:19:27,273] INFO: [1mEpoch #4: Current validation metric: 0.99758 (best: 0.99765)[0m
[2025-09-03 01:19:27,273] INFO: --------------------------------------------------
[2025-09-03 01:19:27,273] INFO: Epoch #5 training
[2025-09-03 01:19:27,295] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:19:27,309] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:20:16,844] INFO: Processed 199680 entries in total (avg. speed 4028.2 entries/s)
[2025-09-03 01:20:16,844] INFO: Train AvgLoss: 0.01701, AvgAcc: 0.99304
[2025-09-03 01:20:16,844] INFO: Train class distribution: 
    [(0, 8026571), (1, 2356789)]
[2025-09-03 01:20:16,868] INFO: Epoch #5 validating
[2025-09-03 01:20:16,890] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:20:18,238] INFO: Processed 9984 entries in total (avg. speed 7291.8 entries/s)
[2025-09-03 01:20:18,238] INFO: Evaluation class distribution: 
    [(0, 401101), (1, 118067)]
[2025-09-03 01:20:18,308] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:20:19,173] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999678]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99804039 0.00195961]
 [0.00366741 0.99633259]]
[2025-09-03 01:20:19,174] INFO: [1mEpoch #5: Current validation metric: 0.99765 (best: 0.99765)[0m
[2025-09-03 01:20:19,174] INFO: --------------------------------------------------
[2025-09-03 01:20:19,174] INFO: Epoch #6 training
[2025-09-03 01:20:19,202] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:20:19,217] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:21:08,373] INFO: Processed 199680 entries in total (avg. speed 4058.7 entries/s)
[2025-09-03 01:21:08,373] INFO: Train AvgLoss: 0.01698, AvgAcc: 0.99303
[2025-09-03 01:21:08,373] INFO: Train class distribution: 
    [(0, 8026482), (1, 2356878)]
[2025-09-03 01:21:08,389] INFO: Epoch #6 validating
[2025-09-03 01:21:08,407] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:21:09,643] INFO: Processed 9984 entries in total (avg. speed 7966.3 entries/s)
[2025-09-03 01:21:09,643] INFO: Evaluation class distribution: 
    [(0, 401131), (1, 118037)]
[2025-09-03 01:21:09,716] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:21:10,654] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99996716]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99802558 0.00197442]
 [0.00366834 0.99633166]]
[2025-09-03 01:21:10,654] INFO: [1mEpoch #6: Current validation metric: 0.99764 (best: 0.99765)[0m
[2025-09-03 01:21:10,654] INFO: --------------------------------------------------
[2025-09-03 01:21:10,655] INFO: Epoch #7 training
[2025-09-03 01:21:10,676] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:21:10,686] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:21:58,934] INFO: Processed 199680 entries in total (avg. speed 4136.0 entries/s)
[2025-09-03 01:21:58,934] INFO: Train AvgLoss: 0.01704, AvgAcc: 0.99299
[2025-09-03 01:21:58,935] INFO: Train class distribution: 
    [(0, 8026643), (1, 2356717)]
[2025-09-03 01:21:58,952] INFO: Epoch #7 validating
[2025-09-03 01:21:58,972] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:22:00,222] INFO: Processed 9984 entries in total (avg. speed 7864.7 entries/s)
[2025-09-03 01:22:00,222] INFO: Evaluation class distribution: 
    [(0, 401139), (1, 118029)]
[2025-09-03 01:22:00,288] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:22:01,122] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99996775]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.99803559 0.00196441]
 [0.00365164 0.99634836]]
[2025-09-03 01:22:01,123] INFO: [1mEpoch #7: Current validation metric: 0.99765 (best: 0.99765)[0m
[2025-09-03 01:22:01,123] INFO: --------------------------------------------------
[2025-09-03 01:22:01,123] INFO: Epoch #8 training
[2025-09-03 01:22:01,142] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:22:01,154] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:22:49,566] INFO: Processed 199680 entries in total (avg. speed 4121.9 entries/s)
[2025-09-03 01:22:49,567] INFO: Train AvgLoss: 0.01699, AvgAcc: 0.99302
[2025-09-03 01:22:49,567] INFO: Train class distribution: 
    [(0, 8026577), (1, 2356783)]
[2025-09-03 01:22:49,593] INFO: Epoch #8 validating
[2025-09-03 01:22:49,613] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:22:50,847] INFO: Processed 9984 entries in total (avg. speed 7967.3 entries/s)
[2025-09-03 01:22:50,847] INFO: Evaluation class distribution: 
    [(0, 401105), (1, 118063)]
[2025-09-03 01:22:50,910] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:22:51,728] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999679]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99809775 0.00190225]
 [0.00373529 0.99626471]]
[2025-09-03 01:22:51,730] INFO: [1mEpoch #8: Current validation metric: 0.99768 (best: 0.99768)[0m
[2025-09-03 01:22:51,730] INFO: --------------------------------------------------
[2025-09-03 01:22:51,730] INFO: Epoch #9 training
[2025-09-03 01:22:51,749] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:22:51,758] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:23:40,268] INFO: Processed 199680 entries in total (avg. speed 4114.0 entries/s)
[2025-09-03 01:23:40,268] INFO: Train AvgLoss: 0.01701, AvgAcc: 0.99304
[2025-09-03 01:23:40,268] INFO: Train class distribution: 
    [(0, 8026478), (1, 2356882)]
[2025-09-03 01:23:40,286] INFO: Epoch #9 validating
[2025-09-03 01:23:40,307] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:23:41,551] INFO: Processed 9984 entries in total (avg. speed 7898.5 entries/s)
[2025-09-03 01:23:41,551] INFO: Evaluation class distribution: 
    [(0, 401103), (1, 118065)]
[2025-09-03 01:23:41,617] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:23:42,425] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999676]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99798057 0.00201943]
 [0.00356583 0.99643417]]
[2025-09-03 01:23:42,426] INFO: [1mEpoch #9: Current validation metric: 0.99763 (best: 0.99768)[0m
[2025-09-03 01:23:42,426] INFO: --------------------------------------------------
[2025-09-03 01:23:42,426] INFO: Epoch #10 training
[2025-09-03 01:23:42,442] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:23:42,455] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:24:31,198] INFO: Processed 199680 entries in total (avg. speed 4094.2 entries/s)
[2025-09-03 01:24:31,198] INFO: Train AvgLoss: 0.01701, AvgAcc: 0.99301
[2025-09-03 01:24:31,198] INFO: Train class distribution: 
    [(0, 8026564), (1, 2356796)]
[2025-09-03 01:24:31,214] INFO: Epoch #10 validating
[2025-09-03 01:24:31,233] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:24:32,481] INFO: Processed 9984 entries in total (avg. speed 7882.4 entries/s)
[2025-09-03 01:24:32,481] INFO: Evaluation class distribution: 
    [(0, 401100), (1, 118068)]
[2025-09-03 01:24:32,546] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:24:33,367] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999671]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99815258 0.00184742]
 [0.00398923 0.99601077]]
[2025-09-03 01:24:33,367] INFO: [1mEpoch #10: Current validation metric: 0.99767 (best: 0.99768)[0m
[2025-09-03 01:24:33,367] INFO: --------------------------------------------------
[2025-09-03 01:24:33,367] INFO: Epoch #11 training
[2025-09-03 01:24:33,385] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:24:33,398] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:25:22,307] INFO: Processed 199680 entries in total (avg. speed 4080.1 entries/s)
[2025-09-03 01:25:22,307] INFO: Train AvgLoss: 0.01696, AvgAcc: 0.99301
[2025-09-03 01:25:22,307] INFO: Train class distribution: 
    [(0, 8026573), (1, 2356787)]
[2025-09-03 01:25:22,323] INFO: Epoch #11 validating
[2025-09-03 01:25:22,346] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:25:23,578] INFO: Processed 9984 entries in total (avg. speed 7954.3 entries/s)
[2025-09-03 01:25:23,579] INFO: Evaluation class distribution: 
    [(0, 401125), (1, 118043)]
[2025-09-03 01:25:23,650] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:25:24,456] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.999968]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.99795824 0.00204176]
 [0.00343095 0.99656905]]
[2025-09-03 01:25:24,456] INFO: [1mEpoch #11: Current validation metric: 0.99764 (best: 0.99768)[0m
[2025-09-03 01:25:24,456] INFO: --------------------------------------------------
[2025-09-03 01:25:24,456] INFO: Epoch #12 training
[2025-09-03 01:25:24,475] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:25:24,486] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:26:13,300] INFO: Processed 199680 entries in total (avg. speed 4088.2 entries/s)
[2025-09-03 01:26:13,301] INFO: Train AvgLoss: 0.01699, AvgAcc: 0.99304
[2025-09-03 01:26:13,301] INFO: Train class distribution: 
    [(0, 8026658), (1, 2356702)]
[2025-09-03 01:26:13,321] INFO: Epoch #12 validating
[2025-09-03 01:26:13,341] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:26:14,572] INFO: Processed 9984 entries in total (avg. speed 7979.4 entries/s)
[2025-09-03 01:26:14,573] INFO: Evaluation class distribution: 
    [(0, 401131), (1, 118037)]
[2025-09-03 01:26:14,636] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:26:15,465] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999679]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99811284 0.00188716]
 [0.00387167 0.99612833]]
[2025-09-03 01:26:15,466] INFO: [1mEpoch #12: Current validation metric: 0.99766 (best: 0.99768)[0m
[2025-09-03 01:26:15,466] INFO: --------------------------------------------------
[2025-09-03 01:26:15,466] INFO: Epoch #13 training
[2025-09-03 01:26:15,485] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:26:15,496] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:27:04,244] INFO: Processed 199680 entries in total (avg. speed 4093.7 entries/s)
[2025-09-03 01:27:04,244] INFO: Train AvgLoss: 0.01696, AvgAcc: 0.99304
[2025-09-03 01:27:04,244] INFO: Train class distribution: 
    [(0, 8026605), (1, 2356755)]
[2025-09-03 01:27:04,261] INFO: Epoch #13 validating
[2025-09-03 01:27:04,281] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:27:05,511] INFO: Processed 9984 entries in total (avg. speed 7990.9 entries/s)
[2025-09-03 01:27:05,511] INFO: Evaluation class distribution: 
    [(0, 401116), (1, 118052)]
[2025-09-03 01:27:05,577] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:27:06,411] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999681]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99805543 0.00194457]
 [0.00372717 0.99627283]]
[2025-09-03 01:27:06,412] INFO: [1mEpoch #13: Current validation metric: 0.99765 (best: 0.99768)[0m
[2025-09-03 01:27:06,412] INFO: --------------------------------------------------
[2025-09-03 01:27:06,412] INFO: Epoch #14 training
[2025-09-03 01:27:06,432] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:27:06,443] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:27:55,055] INFO: Processed 199680 entries in total (avg. speed 4105.1 entries/s)
[2025-09-03 01:27:55,055] INFO: Train AvgLoss: 0.01694, AvgAcc: 0.99305
[2025-09-03 01:27:55,055] INFO: Train class distribution: 
    [(0, 8026486), (1, 2356874)]
[2025-09-03 01:27:55,074] INFO: Epoch #14 validating
[2025-09-03 01:27:55,095] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:27:56,334] INFO: Processed 9984 entries in total (avg. speed 7928.6 entries/s)
[2025-09-03 01:27:56,335] INFO: Evaluation class distribution: 
    [(0, 401115), (1, 118053)]
[2025-09-03 01:27:56,400] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:27:57,236] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999682]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99803298 0.00196702]
 [0.00360855 0.99639145]]
[2025-09-03 01:27:57,236] INFO: [1mEpoch #14: Current validation metric: 0.99766 (best: 0.99768)[0m
[2025-09-03 01:27:57,238] INFO: --------------------------------------------------
[2025-09-03 01:27:57,238] INFO: Epoch #15 training
[2025-09-03 01:27:57,259] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:27:57,270] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:28:46,016] INFO: Processed 199680 entries in total (avg. speed 4093.7 entries/s)
[2025-09-03 01:28:46,016] INFO: Train AvgLoss: 0.01690, AvgAcc: 0.99306
[2025-09-03 01:28:46,017] INFO: Train class distribution: 
    [(0, 8026557), (1, 2356803)]
[2025-09-03 01:28:46,034] INFO: Epoch #15 validating
[2025-09-03 01:28:46,052] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:28:47,294] INFO: Processed 9984 entries in total (avg. speed 7926.7 entries/s)
[2025-09-03 01:28:47,294] INFO: Evaluation class distribution: 
    [(0, 401118), (1, 118050)]
[2025-09-03 01:28:47,357] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:28:48,195] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999681]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99802801 0.00197199]
 [0.00362558 0.99637442]]
[2025-09-03 01:28:48,195] INFO: [1mEpoch #15: Current validation metric: 0.99765 (best: 0.99768)[0m
[2025-09-03 01:28:48,195] INFO: --------------------------------------------------
[2025-09-03 01:28:48,195] INFO: Epoch #16 training
[2025-09-03 01:28:48,214] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:28:48,224] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:29:37,114] INFO: Processed 199680 entries in total (avg. speed 4081.9 entries/s)
[2025-09-03 01:29:37,115] INFO: Train AvgLoss: 0.01698, AvgAcc: 0.99303
[2025-09-03 01:29:37,115] INFO: Train class distribution: 
    [(0, 8026511), (1, 2356849)]
[2025-09-03 01:29:37,131] INFO: Epoch #16 validating
[2025-09-03 01:29:37,150] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:29:38,372] INFO: Processed 9984 entries in total (avg. speed 8045.2 entries/s)
[2025-09-03 01:29:38,373] INFO: Evaluation class distribution: 
    [(0, 401129), (1, 118039)]
[2025-09-03 01:29:38,438] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:29:39,272] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.        0.9999681]
 [0.        0.       ]]
    - confusion_matrix: 
[[0.99802807 0.00197193]
 [0.00358356 0.99641644]]
[2025-09-03 01:29:39,272] INFO: [1mEpoch #16: Current validation metric: 0.99766 (best: 0.99768)[0m
[2025-09-03 01:29:39,273] INFO: --------------------------------------------------
[2025-09-03 01:29:39,273] INFO: Epoch #17 training
[2025-09-03 01:29:39,292] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:29:39,303] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:30:28,161] INFO: Processed 199680 entries in total (avg. speed 4084.5 entries/s)
[2025-09-03 01:30:28,161] INFO: Train AvgLoss: 0.01694, AvgAcc: 0.99305
[2025-09-03 01:30:28,161] INFO: Train class distribution: 
    [(0, 8026612), (1, 2356748)]
[2025-09-03 01:30:28,180] INFO: Epoch #17 validating
[2025-09-03 01:30:28,197] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:30:29,438] INFO: Processed 9984 entries in total (avg. speed 7939.6 entries/s)
[2025-09-03 01:30:29,438] INFO: Evaluation class distribution: 
    [(0, 401117), (1, 118051)]
[2025-09-03 01:30:29,500] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:30:30,325] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.999968]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.99793576 0.00206424]
 [0.00337142 0.99662858]]
[2025-09-03 01:30:30,325] INFO: [1mEpoch #17: Current validation metric: 0.99764 (best: 0.99768)[0m
[2025-09-03 01:30:30,325] INFO: --------------------------------------------------
[2025-09-03 01:30:30,325] INFO: Epoch #18 training
[2025-09-03 01:30:30,344] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:30:30,356] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:31:19,207] INFO: Processed 199680 entries in total (avg. speed 4085.0 entries/s)
[2025-09-03 01:31:19,208] INFO: Train AvgLoss: 0.01687, AvgAcc: 0.99304
[2025-09-03 01:31:19,208] INFO: Train class distribution: 
    [(0, 8026520), (1, 2356840)]
[2025-09-03 01:31:19,226] INFO: Epoch #18 validating
[2025-09-03 01:31:19,245] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:31:20,474] INFO: Processed 9984 entries in total (avg. speed 8002.0 entries/s)
[2025-09-03 01:31:20,474] INFO: Evaluation class distribution: 
    [(0, 401124), (1, 118044)]
[2025-09-03 01:31:20,541] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:31:21,370] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.         0.99996805]
 [0.         0.        ]]
    - confusion_matrix: 
[[0.998043   0.001957  ]
 [0.00363424 0.99636576]]
[2025-09-03 01:31:21,370] INFO: [1mEpoch #18: Current validation metric: 0.99766 (best: 0.99768)[0m
[2025-09-03 01:31:21,370] INFO: --------------------------------------------------
[2025-09-03 01:31:21,370] INFO: Epoch #19 training
[2025-09-03 01:31:21,389] INFO: Restarted DataIter train_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_01.root"
  ]
}
[2025-09-03 01:31:21,400] INFO: Restarted DataIter train_worker1, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/train_02.root"
  ]
}
[2025-09-03 01:32:10,133] INFO: Processed 199680 entries in total (avg. speed 4095.0 entries/s)
[2025-09-03 01:32:10,133] INFO: Train AvgLoss: 0.01689, AvgAcc: 0.99306
[2025-09-03 01:32:10,133] INFO: Train class distribution: 
    [(0, 8026570), (1, 2356790)]
[2025-09-03 01:32:10,152] INFO: Epoch #19 validating
[2025-09-03 01:32:10,173] INFO: Restarted DataIter val_worker0, load_range=(0.0, 1.0), file_list:
{
  "_": [
    "/home/tpyang/B-Reconstruction-2-FPGA/python/gen_level_2B/data/test.root"
  ]
}
[2025-09-03 01:32:11,408] INFO: Processed 9984 entries in total (avg. speed 7953.2 entries/s)
[2025-09-03 01:32:11,408] INFO: Evaluation class distribution: 
    [(0, 401115), (1, 118053)]
[2025-09-03 01:32:11,478] ERROR: y should be a 1d array, got an array of shape (519168, 2) instead.
[2025-09-03 01:32:12,299] INFO: Evaluation metrics: 
    - roc_auc_score: 
None
    - roc_auc_score_matrix: 
[[0.       0.999968]
 [0.       0.      ]]
    - confusion_matrix: 
[[0.9979906 0.0020094]
 [0.0035069 0.9964931]]
[2025-09-03 01:32:12,299] INFO: [1mEpoch #19: Current validation metric: 0.99765 (best: 0.99768)[0m
